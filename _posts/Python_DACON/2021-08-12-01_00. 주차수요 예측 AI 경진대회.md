---
title: "[Python] ë°ì´ì½˜ - ì£¼ì°¨ìˆ˜ìš” ì˜ˆì¸¡ AI ê²½ì§„ëŒ€íšŒ"
excerpt: "ë°ì´ì½˜ ëŒ€íšŒ ì •ë¦¬"
categories: 
  - DACON
tags: 
    - Python
    - DACON
toc: TRUE
toc_sticky: TRUE
use_math: TRUE
---


# ì£¼ì°¨ìˆ˜ìš” ì˜ˆì¸¡ AI ê²½ì§„ëŒ€íšŒ

ê·¸ë™ì•ˆ ê³µë¶€í•œ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ì§ì ‘ ë°ì´í„°ë¥¼ ë‹¤ë¤„ë³´ê¸° ìœ„í•´ ë°ì´ì½˜ ëŒ€íšŒì— ì°¸ì—¬í•˜ì˜€ë‹¤. ëŒ€íšŒ ê¸°ê°„ì€ 2021.06.10 ~ 2021.07.30 ì´ì—ˆìœ¼ë©°, ë‚˜ëŠ” 7ì›” ì´ˆ ë¶€í„° ì°¸ê°€í•˜ì—¬ ì•½ í•œë‹¬ ì •ë„ ë„ì „í•˜ì˜€ë‹¤. ì°¸ê°€í•œ ëŒ€íšŒëŠ” í•œêµ­í† ì§€ì£¼íƒê³µì‚¬ì™€ ë°ì´ì½˜ì´ í•¨ê»˜í•œ [ì£¼ì°¨ìˆ˜ìš” ì˜ˆì¸¡ AI ê²½ì§„ëŒ€íšŒ](https://dacon.io/competitions/official/235745/overview/description)ë¡œ ê° ì•„íŒŒíŠ¸ ë‹¨ì§€ë³„ë¡œ ë“±ë¡ì°¨ëŸ‰ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë¬¸ì œì´ë‹¤.

ë°ì´í„°ëŠ” train, test, age_gender_info(ì§€ì—­ë³„ ì„±ë³„ ì¸êµ¬ ë¹„ìœ¨) 3ê°€ì§€ë¥¼ ì œê³µ ë°›ì•„ ì§„í–‰í•˜ì˜€ë‹¤. ë°ì´ì½˜ì€ í•˜ë£¨ 3ë²ˆê¹Œì§€ testì— ëŒ€í•œ ì˜ˆì¸¡ê°’ì„ ì œì¶œí•˜ì—¬ ê·¸ ì¤‘ ì¼ë¶€ì— ëŒ€í•œ ì ìˆ˜ë¥¼ ë°”ë¡œ í™•ì¸ í•  ìˆ˜ ìˆì–´ ì´ ì ìˆ˜ë¥¼ í† ëŒ€ë¡œ ìˆ˜ì •ì„ ê±°ë“­í•˜ë©´ì„œ ë” ì¢‹ì€ ëª¨ë¸ì„ ì°¾ì•„ ë‚˜ê°”ë‹¤. ë°ì´ì½˜ ê²Œì‹œíŒì—ì„œ ë² ì´ìŠ¤ë¼ì¸ ì½”ë“œ(ëœë¤í¬ë ˆìŠ¤íŠ¸)ë¥¼ ê³µìœ í•´ì£¼ì—ˆê³  ì‚¬ëŒë“¤ë¼ë¦¬ë„ ì½”ë“œì™€ ë³¸ì¸ ì˜ê²¬ì„ ì˜¬ë¦¬ê¸°ë„ í•˜ì—¬ ì—¬ëŸ¬ëª¨ë¡œ ê³µë¶€ë„ ë§ì´ ë˜ì—ˆë‹¤.

ê·¸ë™ì•ˆ ì°¸ê°€í•˜ë©´ì„œ ì§„ì§œ ë§ì€ ì‹œë„ë„ í•´ë³´ì•˜ê³  ëª¨ë¸ì´ ë…¼ë¦¬ì ìœ¼ë¡œ ë§ëŠ”ì§€, ë³„ê°œë¡œ ë‹¤ì–‘í•œ ëª¨ë¸ì„ ëŒë ¤ë³´ê³  ê²°ê³¼ì— ë”°ë¼ ì´ìœ ê°€ ë¬´ì—‡ì¸ì§€ ê³ ë¯¼ì„ ë§ì´ í–ˆë˜ ê²ƒ ê°™ë‹¤. í•œ ë‹¬ë™ì•ˆ ì›Œë‚™ ë§ì€ ë²„ì „ìœ¼ë¡œ ì œì¶œì„ í•˜ê³  ì œë•Œ ì •ë¦¬í•˜ì§€ ëª»í–ˆëŠ”ë° ê·¸ ì¤‘ ì¼ë¶€ì— ëŒ€í•´ ì—…ë¡œë“œ í•˜ë ¤í•œë‹¤. ìµœì¢… ì œì¶œë²„ì „ ë³´ë‹¤ëŠ” ë‚´ê°€ ê³ ë¯¼í–ˆë˜ ìƒê°ì´ë‚˜ ì‹œë„í•´ë³¸ ì½”ë“œ ìœ„ì£¼ë¡œ ì ì–´ë‘ì—ˆë‹¤.

ì•„ë˜ëŠ” ë°ì´ì½˜ì—ì„œ ì œê³µí•œ ìì„¸í•œ ëŒ€íšŒ ì•ˆë‚´ì´ë‹¤.

**[ë°°ê²½]**

ì•„íŒŒíŠ¸ ë‹¨ì§€ ë‚´ í•„ìš”í•œ ì£¼ì°¨ëŒ€ìˆ˜ëŠ” â‘ ë²•ì •ì£¼ì°¨ëŒ€ìˆ˜ â‘¡ì¥ë˜ì£¼ì°¨ìˆ˜ìš” ì¤‘ í° ê°’ì— ë”°ë¼ ê²°ì •í•˜ê²Œë˜ì–´ ìˆì–´, 

ì •í™•í•œ â‘¡ì¥ë˜ì£¼ì°¨ìˆ˜ìš”ì˜ ì‚°ì •ì„ í•„ìš”ë¡œ í•©ë‹ˆë‹¤.

í˜„ì¬ â‘¡ì¥ë˜ì£¼ì°¨ìˆ˜ìš”ëŠ” â€˜ì£¼ì°¨ì›ë‹¨ìœ„â€™ì™€ â€˜ê±´ì¶•ì—°ë©´ì â€™ì„ ê¸°ì´ˆë¡œí•˜ì—¬ ì‚°ì¶œë˜ê³  ìˆìœ¼ë©°, 

â€˜ì£¼ì°¨ì›ë‹¨ìœ„â€™ëŠ” ì‹ ê·œ ê±´ì¶•ì˜ˆì • ë¶€ì§€ ì¸ê·¼ì˜ ìœ ì‚¬ ë‹¨ì§€ë¥¼ í”¼í¬ ì‹œê°„ëŒ€ ë°©ë¬¸í•˜ì—¬ ì£¼ì°¨ëœ ì°¨ëŸ‰ëŒ€ìˆ˜ë¥¼ ì„¸ëŠ” ë°©ë²•ìœ¼ë¡œ ì¡°ì‚¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.

ì´ ê²½ìš° ì¸ë ¥ì¡°ì‚¬ë¡œ ì¸í•œ ì˜¤ì°¨ë°œìƒ, í˜„ì¥ì¡°ì‚¬ ì‹œì ê³¼ ì‹¤ì œ ê±´ì¶•ì‹œì ê³¼ì˜ ì‹œê°„ì°¨ ë“±ì˜ ë¬¸ì œë¡œ ê³¼ëŒ€ ë˜ëŠ” ê³¼ì†Œ ì‚°ì •ì˜ ê°€ëŠ¥ì„±ì„ ë°°ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.


**[ì£¼ì œ]**

ğŸ  ìœ í˜•ë³„ ì„ëŒ€ì£¼íƒ ì„¤ê³„ ì‹œ ë‹¨ì§€ ë‚´ ì ì • ğŸ…¿ï¸ ì£¼ì°¨ ìˆ˜ìš”ë¥¼ ì˜ˆì¸¡

**[í‰ê°€]**

í‰ê°€ì‚°ì‹ : MAE(Mean Absolute Error)

Public í‰ê°€ : ì „ì²´ Test ë°ì´í„° ì¤‘ ë¬´ì‘ìœ„ 33% (50ë‹¨ì§€)

Private í‰ê°€ : ì „ì²´ Test ë°ì´í„° ì¤‘ ë‚˜ë¨¸ì§€ 67% (100ë‹¨ì§€)


**ê¸°ë³¸ ì„¸íŒ…**


```python
import numpy as np
import pandas as pd

import matplotlib as mpl
import matplotlib.pyplot as plt
import seaborn as sns

import missingno as msno

import warnings

from sklearn.preprocessing import StandardScaler, RobustScaler

from sklearn.model_selection import KFold, StratifiedKFold
from sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV
from sklearn.metrics import mean_absolute_error, make_scorer

from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestRegressor
from sklearn.linear_model import LinearRegression, Ridge, Lasso, ElasticNet, PoissonRegressor
from xgboost import XGBRegressor
from lightgbm import LGBMRegressor
from catboost import CatBoostRegressor

from statsmodels.stats.outliers_influence import variance_inflation_factor

from pycaret.regression import *
import optuna
from optuna import Trial
from optuna.samplers import TPESampler
```


```python
%matplotlib inline
%config InlineBackend.figure_format = 'retina'

mpl.rc('font', family='NanumGothic') # í°íŠ¸ ì„¤ì •
mpl.rc('axes', unicode_minus=False) # ìœ ë‹ˆì½”ë“œì—ì„œ ìŒìˆ˜ ë¶€í˜¸ ì„¤ì •

# ì°¨íŠ¸ ìŠ¤íƒ€ì¼ ì„¤ì •
sns.set(font="NanumGothic", rc={"axes.unicode_minus":False}, style='darkgrid')
plt.rc("figure", figsize=(10,8))

warnings.filterwarnings("ignore")
```

---

## 1.1 ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°


```python
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
train_df = pd.read_csv('train.csv')
test_df = pd.read_csv('test.csv')
submission = pd.read_csv('sample_submission.csv')
age_gender_info = pd.read_csv('age_gender_info.csv')
```


```python
train_df.shape, test_df.shape
```




    ((2952, 15), (1022, 14))




```python
train_df.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <th>ì„ëŒ€ê±´ë¬¼êµ¬ë¶„</th>
      <th>ì§€ì—­</th>
      <th>ê³µê¸‰ìœ í˜•</th>
      <th>ì „ìš©ë©´ì </th>
      <th>ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜</th>
      <th>ê³µê°€ìˆ˜</th>
      <th>ìê²©ìœ í˜•</th>
      <th>ì„ëŒ€ë³´ì¦ê¸ˆ</th>
      <th>ì„ëŒ€ë£Œ</th>
      <th>ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ì§€í•˜ì² ì—­ ìˆ˜(í™˜ìŠ¹ë…¸ì„  ìˆ˜ ë°˜ì˜)</th>
      <th>ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ ìˆ˜</th>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
      <th>ë“±ë¡ì°¨ëŸ‰ìˆ˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C2483</td>
      <td>900</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê²½ìƒë¶ë„</td>
      <td>êµ­ë¯¼ì„ëŒ€</td>
      <td>39.72</td>
      <td>134</td>
      <td>38.0</td>
      <td>A</td>
      <td>15667000</td>
      <td>103680</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C2483</td>
      <td>900</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê²½ìƒë¶ë„</td>
      <td>êµ­ë¯¼ì„ëŒ€</td>
      <td>39.72</td>
      <td>15</td>
      <td>38.0</td>
      <td>A</td>
      <td>15667000</td>
      <td>103680</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C2483</td>
      <td>900</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê²½ìƒë¶ë„</td>
      <td>êµ­ë¯¼ì„ëŒ€</td>
      <td>51.93</td>
      <td>385</td>
      <td>38.0</td>
      <td>A</td>
      <td>27304000</td>
      <td>184330</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>1425.0</td>
      <td>1015.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
test_df.head(3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <th>ì„ëŒ€ê±´ë¬¼êµ¬ë¶„</th>
      <th>ì§€ì—­</th>
      <th>ê³µê¸‰ìœ í˜•</th>
      <th>ì „ìš©ë©´ì </th>
      <th>ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜</th>
      <th>ê³µê°€ìˆ˜</th>
      <th>ìê²©ìœ í˜•</th>
      <th>ì„ëŒ€ë³´ì¦ê¸ˆ</th>
      <th>ì„ëŒ€ë£Œ</th>
      <th>ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ì§€í•˜ì² ì—­ ìˆ˜(í™˜ìŠ¹ë…¸ì„  ìˆ˜ ë°˜ì˜)</th>
      <th>ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ ìˆ˜</th>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C1072</td>
      <td>754</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê²½ê¸°ë„</td>
      <td>êµ­ë¯¼ì„ëŒ€</td>
      <td>39.79</td>
      <td>116</td>
      <td>14.0</td>
      <td>H</td>
      <td>22830000</td>
      <td>189840</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1072</td>
      <td>754</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê²½ê¸°ë„</td>
      <td>êµ­ë¯¼ì„ëŒ€</td>
      <td>46.81</td>
      <td>30</td>
      <td>14.0</td>
      <td>A</td>
      <td>36048000</td>
      <td>249930</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C1072</td>
      <td>754</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê²½ê¸°ë„</td>
      <td>êµ­ë¯¼ì„ëŒ€</td>
      <td>46.90</td>
      <td>112</td>
      <td>14.0</td>
      <td>H</td>
      <td>36048000</td>
      <td>249930</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>683.0</td>
    </tr>
  </tbody>
</table>
</div>



- testì— ì—†ëŠ” ë“±ë¡ì°¨ëŸ‰ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ë©´ ëœë‹¤.


```python
train_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 2952 entries, 0 to 2951
    Data columns (total 15 columns):
     #   Column                        Non-Null Count  Dtype  
    ---  ------                        --------------  -----  
     0   ë‹¨ì§€ì½”ë“œ                          2952 non-null   object 
     1   ì´ì„¸ëŒ€ìˆ˜                          2952 non-null   int64  
     2   ì„ëŒ€ê±´ë¬¼êµ¬ë¶„                        2952 non-null   object 
     3   ì§€ì—­                            2952 non-null   object 
     4   ê³µê¸‰ìœ í˜•                          2952 non-null   object 
     5   ì „ìš©ë©´ì                           2952 non-null   float64
     6   ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜                      2952 non-null   int64  
     7   ê³µê°€ìˆ˜                           2952 non-null   float64
     8   ìê²©ìœ í˜•                          2952 non-null   object 
     9   ì„ëŒ€ë³´ì¦ê¸ˆ                         2383 non-null   object 
     10  ì„ëŒ€ë£Œ                           2383 non-null   object 
     11  ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ì§€í•˜ì² ì—­ ìˆ˜(í™˜ìŠ¹ë…¸ì„  ìˆ˜ ë°˜ì˜)  2741 non-null   float64
     12  ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ ìˆ˜            2948 non-null   float64
     13  ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜                       2952 non-null   float64
     14  ë“±ë¡ì°¨ëŸ‰ìˆ˜                         2952 non-null   float64
    dtypes: float64(6), int64(2), object(7)
    memory usage: 346.1+ KB
    


```python
test_df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 1022 entries, 0 to 1021
    Data columns (total 14 columns):
     #   Column                        Non-Null Count  Dtype  
    ---  ------                        --------------  -----  
     0   ë‹¨ì§€ì½”ë“œ                          1022 non-null   object 
     1   ì´ì„¸ëŒ€ìˆ˜                          1022 non-null   int64  
     2   ì„ëŒ€ê±´ë¬¼êµ¬ë¶„                        1022 non-null   object 
     3   ì§€ì—­                            1022 non-null   object 
     4   ê³µê¸‰ìœ í˜•                          1022 non-null   object 
     5   ì „ìš©ë©´ì                           1022 non-null   float64
     6   ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜                      1022 non-null   int64  
     7   ê³µê°€ìˆ˜                           1022 non-null   float64
     8   ìê²©ìœ í˜•                          1020 non-null   object 
     9   ì„ëŒ€ë³´ì¦ê¸ˆ                         842 non-null    object 
     10  ì„ëŒ€ë£Œ                           842 non-null    object 
     11  ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ì§€í•˜ì² ì—­ ìˆ˜(í™˜ìŠ¹ë…¸ì„  ìˆ˜ ë°˜ì˜)  980 non-null    float64
     12  ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ ìˆ˜            1022 non-null   float64
     13  ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜                       1022 non-null   float64
    dtypes: float64(5), int64(2), object(7)
    memory usage: 111.9+ KB
    

- ì²˜ìŒ ë°ì´í„° êµ¬ì¡°ë¥¼ í™•ì¸í•˜ì˜€ì„ ë•Œ train, test ëª¨ë‘ ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œì˜ íƒ€ì…ì´ objectë¡œ ì…ë ¥ë˜ì–´ ìˆì—ˆë‹¤.


```python
# ì»¬ëŸ¼ëª… ë³€ê²½
rename_col_lst = {"ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ì§€í•˜ì² ì—­ ìˆ˜(í™˜ìŠ¹ë…¸ì„  ìˆ˜ ë°˜ì˜)": "ì§€í•˜ì² ìˆ˜",
                  "ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ ìˆ˜": "ë²„ìŠ¤ìˆ˜"}

train_df.rename(columns = rename_col_lst, inplace=True)
test_df.rename(columns = rename_col_lst, inplace=True)
```

- ìš°ì„  ì»¬ëŸ¼ëª…ì´ ë„ˆë¬´ ê¸¸ì–´ ì§€í•˜ì² ìˆ˜, ë²„ìŠ¤ìˆ˜ë¡œ ì§§ê²Œ ë³€ê²½í•´ë‘ì—ˆë‹¤.


```python
train_df.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <td>2952.0</td>
      <td>886.661247</td>
      <td>513.540168</td>
      <td>26.00</td>
      <td>513.50</td>
      <td>779.00</td>
      <td>1106.0000</td>
      <td>2568.0</td>
    </tr>
    <tr>
      <th>ì „ìš©ë©´ì </th>
      <td>2952.0</td>
      <td>44.757215</td>
      <td>31.874280</td>
      <td>12.62</td>
      <td>32.10</td>
      <td>39.93</td>
      <td>51.5625</td>
      <td>583.4</td>
    </tr>
    <tr>
      <th>ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜</th>
      <td>2952.0</td>
      <td>102.747967</td>
      <td>132.640159</td>
      <td>1.00</td>
      <td>14.00</td>
      <td>60.00</td>
      <td>144.0000</td>
      <td>1865.0</td>
    </tr>
    <tr>
      <th>ê³µê°€ìˆ˜</th>
      <td>2952.0</td>
      <td>12.921070</td>
      <td>10.778831</td>
      <td>0.00</td>
      <td>4.00</td>
      <td>11.00</td>
      <td>20.0000</td>
      <td>55.0</td>
    </tr>
    <tr>
      <th>ì§€í•˜ì² ìˆ˜</th>
      <td>2741.0</td>
      <td>0.176578</td>
      <td>0.427408</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>0.0000</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>ë²„ìŠ¤ìˆ˜</th>
      <td>2948.0</td>
      <td>3.695726</td>
      <td>2.644665</td>
      <td>0.00</td>
      <td>2.00</td>
      <td>3.00</td>
      <td>4.0000</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
      <td>2952.0</td>
      <td>601.668360</td>
      <td>396.407072</td>
      <td>13.00</td>
      <td>279.25</td>
      <td>517.00</td>
      <td>823.0000</td>
      <td>1798.0</td>
    </tr>
    <tr>
      <th>ë“±ë¡ì°¨ëŸ‰ìˆ˜</th>
      <td>2952.0</td>
      <td>559.768293</td>
      <td>433.375027</td>
      <td>13.00</td>
      <td>220.00</td>
      <td>487.00</td>
      <td>770.0000</td>
      <td>2550.0</td>
    </tr>
  </tbody>
</table>
</div>



- ì²˜ìŒ í™•ì¸í•˜ì˜€ì„ ë•Œ ë“  ìƒê°ì€ ì§€í•˜ì² ìˆ˜ëŠ” ê±°ì˜ ë‹¤ 0ì´ì—ˆê³  ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜ í‰ê· ì´ ì¤‘ì•™ê°’ë³´ë‹¤ í° ê²ƒì´ ë³´ì˜€ë‹¤.


- ì´ëŸ° ì  ë•Œë¬¸ì— ê° ì»¬ëŸ¼ë³„ë¡œ ì™œê³¡ë„ë¥¼ ê³„ì‚°í•˜ì—¬ì„œ ìŠ¤ì¼€ì¼ë§ í• ê¹Œ? ìƒê°í•˜ì˜€ë˜ ê²ƒ ê°™ë‹¤.


- ì´ì „ì— [ë¨¸ì‹ ëŸ¬ë‹ ì™„ë²½ê°€ì´ë“œ](https://romg2.github.io/mlguide/10_%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C-05.-%ED%9A%8C%EA%B7%80-%EC%8B%A4%EC%8A%B5/#224-%ED%94%BC%EC%B2%98-%EB%A1%9C%EA%B7%B8-%EB%B3%80%ED%99%98)ì—ì„œ ë¹„ìŠ·í•œ ê²½í—˜ì´ ìˆì–´ ì´ ì  ë¶€í„° ê³ ë ¤í•˜ì˜€ë‹¤.


```python
test_df.describe().T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <td>1022.0</td>
      <td>862.080235</td>
      <td>536.340894</td>
      <td>75.00</td>
      <td>488.000</td>
      <td>745.00</td>
      <td>1161.0</td>
      <td>2572.0</td>
    </tr>
    <tr>
      <th>ì „ìš©ë©´ì </th>
      <td>1022.0</td>
      <td>43.706311</td>
      <td>35.890759</td>
      <td>9.96</td>
      <td>33.135</td>
      <td>39.72</td>
      <td>47.4</td>
      <td>583.4</td>
    </tr>
    <tr>
      <th>ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜</th>
      <td>1022.0</td>
      <td>100.414873</td>
      <td>125.997855</td>
      <td>1.00</td>
      <td>14.000</td>
      <td>60.00</td>
      <td>140.0</td>
      <td>1341.0</td>
    </tr>
    <tr>
      <th>ê³µê°€ìˆ˜</th>
      <td>1022.0</td>
      <td>15.544031</td>
      <td>11.070140</td>
      <td>0.00</td>
      <td>6.000</td>
      <td>15.00</td>
      <td>23.0</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>ì§€í•˜ì² ìˆ˜</th>
      <td>980.0</td>
      <td>0.136735</td>
      <td>0.435500</td>
      <td>0.00</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>ë²„ìŠ¤ìˆ˜</th>
      <td>1022.0</td>
      <td>4.626223</td>
      <td>5.414568</td>
      <td>1.00</td>
      <td>2.000</td>
      <td>3.00</td>
      <td>5.0</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
      <td>1022.0</td>
      <td>548.771037</td>
      <td>342.636703</td>
      <td>29.00</td>
      <td>286.000</td>
      <td>458.00</td>
      <td>711.0</td>
      <td>1696.0</td>
    </tr>
  </tbody>
</table>
</div>



- testì—ì„  ë²„ìŠ¤ìˆ˜ê°€ 50ì¸ ê²ƒì´ ëˆˆì— ëˆë‹¤.

## 1.2 ê²°ì¸¡ê°’ ëŒ€ì²´


```python
msno.bar(train_df)
plt.show()
```


    
![png](../../assets/images/post_images/2021-08-12-01/output_23_0.png)



- trainì€ `info`ë¡œ í™•ì¸í–ˆë“¯ì´ ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œ, ì§€í•˜ì² ìˆ˜, ë²„ìŠ¤ìˆ˜ì— ê²°ì¸¡ì´ ì¡´ì¬í•œë‹¤.


```python
msno.bar(test_df)
plt.show()
```


    
![png](../../assets/images/post_images/2021-08-12-01/output_25_0.png)
    


- testëŠ” `info()`ë¡œ í™•ì¸í–ˆë“¯ì´ ìê²©ìœ í˜•, ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œ, ì§€í•˜ì² ìˆ˜ì— ê²°ì¸¡ì´ ì¡´ì¬í•œë‹¤.

### 1.2.1 ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œ


```python
# train["ì„ëŒ€ë³´ì¦ê¸ˆ"].value_counts().sort_index()
# train["ì„ëŒ€ë£Œ"].value_counts().sort_index()
# test["ì„ëŒ€ë³´ì¦ê¸ˆ"].value_counts().sort_index()
# test["ì„ëŒ€ë£Œ"].value_counts().sort_index()

# ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œ "-" ê°’, ê²°ì¸¡ê°’ 0 ìœ¼ë¡œ ëŒ€ì²´, intí˜•ìœ¼ë¡œ ë°”ê¾¸ê¸°
nan_lst = ["ì„ëŒ€ë³´ì¦ê¸ˆ","ì„ëŒ€ë£Œ"]

for column in nan_lst:
    train_df[column].replace("-", "0", inplace = True)
    train_df[column].fillna("0", inplace = True)
    train_df[column] = train_df[column].astype(int)
    
    test_df[column].replace("-", "0", inplace = True)
    test_df[column].fillna("0", inplace = True)
    test_df[column] = test_df[column].astype(int)
```

- ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œì˜ "-" ê°’, ê²°ì¸¡ê°’ì€ 0ìœ¼ë¡œ ëŒ€ì²´í•˜ì˜€ë‹¤.


- ìê²©ìœ í˜•ë³„ ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œì˜ í‰ê· ì´ë‚˜ ì¤‘ì•™ê°’ ëŒ€ì²´ë„ ê³ ë ¤í•˜ì˜€ìœ¼ë‚˜ ê²°êµ­ ìµœì¢…ë²„ì „ì—ì„œë„ 0ìœ¼ë¡œ ëŒ€ì²´í•˜ì˜€ë‹¤.


- ì†”ì§íˆ ì£¼íƒ ë°ì´í„°ì— ëŒ€í•œ ë„ë©”ì¸ì´ ë¶€ì¡±í•˜ê³  ê°œë… ê³µë¶€ì— ì‹œê°„ì„ ë§ì´ ìŸì§€ ëª»í•´ ë…¼ë¦¬ ì—†ì´ ëŒ€ì²´í•˜ê¸°ê°€ í˜ë“¤ì—ˆë‹¤.


- ë‹¤ë¥¸ ì‚¬ëŒë“¤ë„ ëŒ€ë¶€ë¶„ 0ìœ¼ë¡œ ëŒ€ì²´í•˜ê¸°ë„ í•˜ì˜€ë‹¤.

### 1.2.2 ì§€í•˜ì² ìˆ˜, ë²„ìŠ¤ìˆ˜


```python
# train ì§€í•˜ì² ìˆ˜, ë²„ìŠ¤ìˆ˜ ê²°ì¸¡ê°’ 0ìœ¼ë¡œ ëŒ€ì²´
train_df["ì§€í•˜ì² ìˆ˜"].fillna(0, inplace = True)
train_df["ë²„ìŠ¤ìˆ˜"].fillna(0, inplace = True)

# test ì§€í•˜ì² ìˆ˜ ê²°ì¸¡ê°’ 0ìœ¼ë¡œ ëŒ€ì²´
test_df["ì§€í•˜ì² ìˆ˜"].fillna(0, inplace = True)
```

- ì§€í•˜ì² ìˆ˜, ë²„ìŠ¤ìˆ˜ ê²°ì¸¡ê°’ì€ 0ìœ¼ë¡œ ëŒ€ì²´í•˜ì˜€ë‹¤.


- ì§€í•˜ì² ìˆ˜ëŠ” train, test í•©ì³ì„œ 0 ~ 3ìœ¼ë¡œ ë‚˜ì˜¨ë‹¤.


- floatí˜•ì´ì§€ë§Œ í‰ê· ê°’ì„ ì“°ëŠ”ê±´ ì•ˆ ë§ë‹¤ê³  ìƒê°í•˜ì˜€ê³  train, test ë‘˜ ë‹¤ 0ì´ ì¤‘ì•™ê°’ì´ë©° ìµœë¹ˆê°’ì´ì—ˆë‹¤.

### 1.2.3 ìê²©ìœ í˜•


```python
test_df[test_df["ìê²©ìœ í˜•"].isnull()]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <th>ì„ëŒ€ê±´ë¬¼êµ¬ë¶„</th>
      <th>ì§€ì—­</th>
      <th>ê³µê¸‰ìœ í˜•</th>
      <th>ì „ìš©ë©´ì </th>
      <th>ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜</th>
      <th>ê³µê°€ìˆ˜</th>
      <th>ìê²©ìœ í˜•</th>
      <th>ì„ëŒ€ë³´ì¦ê¸ˆ</th>
      <th>ì„ëŒ€ë£Œ</th>
      <th>ì§€í•˜ì² ìˆ˜</th>
      <th>ë²„ìŠ¤ìˆ˜</th>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>196</th>
      <td>C2411</td>
      <td>962</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê²½ìƒë‚¨ë„</td>
      <td>êµ­ë¯¼ì„ëŒ€</td>
      <td>46.90</td>
      <td>240</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>71950000</td>
      <td>37470</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>840.0</td>
    </tr>
    <tr>
      <th>258</th>
      <td>C2253</td>
      <td>1161</td>
      <td>ì•„íŒŒíŠ¸</td>
      <td>ê°•ì›ë„</td>
      <td>ì˜êµ¬ì„ëŒ€</td>
      <td>26.37</td>
      <td>745</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>2249000</td>
      <td>44770</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>173.0</td>
    </tr>
  </tbody>
</table>
</div>



- testì˜ ìê²©ìœ í˜•ì´ ê²°ì¸¡ì¸ ê±´ì€ ë¬´ì—‡ìœ¼ë¡œ ëŒ€ì²´í• ì§€ ê³ ë¯¼ë˜ì—ˆë‹¤.


- ë°ì´ì½˜ì˜ ë‹¤ë¥¸ ë¶„ë“¤ì˜ ì˜ê²¬ì„ ì°¸ê³ í•˜ì—¬ ë‹¨ì§€ì½”ë“œ, ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œì— ë”°ë¼ ìê²©ìœ í˜•ì„ í™•ì¸í•´ë³´ì•˜ë‹¤.


```python
temp = test_df.pivot_table("ì´ì„¸ëŒ€ìˆ˜", ["ë‹¨ì§€ì½”ë“œ","ì„ëŒ€ë³´ì¦ê¸ˆ","ì„ëŒ€ë£Œ"], "ìê²©ìœ í˜•", aggfunc="count")
temp["ìê²©ìœ í˜•ì¢…ë¥˜"] = np.nan

for row in range(temp.shape[0]):
    not_nan = temp.iloc[row].notnull()
    value = str(list(not_nan[not_nan == True].index))
    
    temp.iloc[row, temp.shape[1]-1] = value
    

temp2 = temp.reset_index()[["ë‹¨ì§€ì½”ë“œ","ì„ëŒ€ë³´ì¦ê¸ˆ","ì„ëŒ€ë£Œ","ìê²©ìœ í˜•ì¢…ë¥˜"]]
temp2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ìê²©ìœ í˜•</th>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th>ì„ëŒ€ë³´ì¦ê¸ˆ</th>
      <th>ì„ëŒ€ë£Œ</th>
      <th>ìê²©ìœ í˜•ì¢…ë¥˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C1003</td>
      <td>12000000</td>
      <td>61000</td>
      <td>['J']</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1003</td>
      <td>18800000</td>
      <td>96000</td>
      <td>['J']</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C1003</td>
      <td>19600000</td>
      <td>100000</td>
      <td>['J']</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C1003</td>
      <td>25600000</td>
      <td>131000</td>
      <td>['J']</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C1003</td>
      <td>30000000</td>
      <td>154000</td>
      <td>['J']</td>
    </tr>
  </tbody>
</table>
</div>




```python
temp2["ìê²©ìœ í˜•ì¢…ë¥˜"].value_counts()
```




    ['A']         310
    ['H']          46
    ['J']          41
    ['C']          19
    ['A', 'H']     10
    ['K']           7
    ['D']           7
    ['L']           6
    ['E']           6
    ['N']           5
    ['I']           5
    ['M']           1
    ['G']           1
    Name: ìê²©ìœ í˜•ì¢…ë¥˜, dtype: int64



- ìœ„ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ í™•ì¸í•˜ì˜€ì„ ë•Œ 10ê±´ë§Œ ì œì™¸í•˜ê³  í•œ ê°€ì§€ ìê²©ìœ í˜•ìœ¼ë¡œ ë¶„ë¥˜ë˜ì—ˆë‹¤.


```python
temp2[(temp2["ë‹¨ì§€ì½”ë“œ"]=="C2411")]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ìê²©ìœ í˜•</th>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th>ì„ëŒ€ë³´ì¦ê¸ˆ</th>
      <th>ì„ëŒ€ë£Œ</th>
      <th>ìê²©ìœ í˜•ì¢…ë¥˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>392</th>
      <td>C2411</td>
      <td>11992000</td>
      <td>100720</td>
      <td>['A']</td>
    </tr>
    <tr>
      <th>393</th>
      <td>C2411</td>
      <td>21586000</td>
      <td>171480</td>
      <td>['A']</td>
    </tr>
  </tbody>
</table>
</div>



- ì•ì„œ ìê²©ìœ í˜•ì´ ê²°ì¸¡ì¸ 2ê±´ì˜ ë‹¨ì§€ì½”ë“œë¥¼ í•˜ë‚˜ì”© í™•ì¸í•˜ì˜€ë‹¤.


- C2411ì€ ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œì— ê´€ê³„ì—†ì´ ìê²©ìœ í˜•ì´ Aë¡œ ë‚˜íƒ€ë‚˜ Aë¡œ ëŒ€ì²´í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤.


```python
temp2[(temp2["ë‹¨ì§€ì½”ë“œ"]=="C2253")]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ìê²©ìœ í˜•</th>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th>ì„ëŒ€ë³´ì¦ê¸ˆ</th>
      <th>ì„ëŒ€ë£Œ</th>
      <th>ìê²©ìœ í˜•ì¢…ë¥˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>351</th>
      <td>C2253</td>
      <td>0</td>
      <td>0</td>
      <td>['D']</td>
    </tr>
    <tr>
      <th>352</th>
      <td>C2253</td>
      <td>3731000</td>
      <td>83020</td>
      <td>['C']</td>
    </tr>
  </tbody>
</table>
</div>



- C2253ì€ ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œê°€ 0ì´ë©´(ì¦‰, ì›ë˜ ê²°ì¸¡)ì´ë©´ ìê²©ìœ í˜•ì´ D, ì•„ë‹ˆë©´ Cë¡œ ë‚˜íƒ€ë‚˜ Cë¡œ ëŒ€ì²´í•˜ì˜€ë‹¤.


```python
# test ìê²©ìœ í˜• ê²°ì¸¡ê°’ ëŒ€ì²´
test_df.loc[196, "ìê²©ìœ í˜•"] = "A"
test_df.loc[258, "ìê²©ìœ í˜•"] = "C"

print("train ê²°ì¸¡ ìˆ˜:", train_df.isna().sum().sum())
print("test ê²°ì¸¡ ìˆ˜:", test_df.isna().sum().sum())
```

    train ê²°ì¸¡ ìˆ˜: 0
    test ê²°ì¸¡ ìˆ˜: 0
    

- train, test ëª¨ë‘ ê²°ì¸¡ ì œê±° ì™„ë£Œë˜ì—ˆë‹¤.

## 1.3 ì¸ì½”ë”©

ê²°ì¸¡ ì œê±°ê¹Œì§€ ì™„ë£Œëœ í›„ ë¬¸ì œëŠ” ìµœì¢…ì ìœ¼ë¡œëŠ” ì•„íŒŒíŠ¸ ë‹¨ì§€ë³„ë¡œ ë“±ë¡ì°¨ëŸ‰ìˆ˜ë¥¼ ì˜ˆì¸¡í•˜ì—¬ì•¼ í•˜ëŠ”ë° ê¸°ì¡´ ë°ì´í„°ëŠ” ë‹¨ì§€ì½”ë“œê°€ ì¤‘ë³µìœ¼ë¡œ ë“¤ì–´ê°€ ìˆì–´ ì´ë¥¼ ë‹¨ì§€ì½”ë“œ ë ˆë²¨ë¡œ ìˆ˜ì •í•  í•„ìš”ê°€ ìˆì—ˆë‹¤. ì´ ê³¼ì •ì—ì„œ ì›-í•« ì¸ì½”ë”©ê³¼ ëŒ€í‘œê°’ ë“±ì„ ì–´ë–»ê²Œ ë§Œë“¤ê¹Œ ê³ ë¯¼ì„ ë§ì´ í–ˆë˜ ê²ƒ ê°™ë‹¤. ì•„ë˜ëŠ” ê° ì»¬ëŸ¼ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í•  ì§€ ë‹¹ì‹œì— ìƒê°í•˜ê³  ì ì–´ë‘ì—ˆë˜ ì´ˆê¸° ê³ ë¯¼ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™”ë‹¤. ì´ì „ì— ì´ë¯¸ ë°ì´í„°ë¥¼ ê³„ì† í™•ì¸í•´ì„œ ì–´ëŠì •ë„ ìƒí™©ì„ íŒŒì•…í•˜ê³  ì ì–´ë‘” ë‚´ìš©ì´ë‹¤.

- ì„ëŒ€ê±´ë¬¼êµ¬ë¶„: ì› í•« ì¸ì½”ë”© ì£¼ìƒë³µí•© ì¶”ê°€ í›„ ì›í•«ì¸ì½”ë”©ë„ ë  ê±° ê°™ìŒ


- ê³µê¸‰ìœ í˜•: ì¼ë¶€ í†µí•©í•´ì„œ ì“°ê±°ë‚˜ ì¼ë‹¨ ê·¸ëŒ€ë¡œ í˜¹ì€ ì•ˆì“°ê±°ë‚˜


- ì „ìš©ë©´ì : êµ¬ê°„ ë‚˜ëˆˆ í›„ ì›í•«ì¸ì½”ë”© (ì´ ê±´ë¬¼ì´ ì „ìš©ë©´ì ì´ íŠ¹ì • ì¼€ì´ìŠ¤ê°€ ìˆë‹¤. ì˜ë¯¸ë‹ˆê¹Œ)


- ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜: ì „ìš©ë©´ì ì´ë‘ ê°™ì´ì¨ì•¼ëŠ”ì§€


- ìê²©ìœ í˜•: ê°€ì¥ ë¹ˆë„ê°€ ë§ì€? (ìê²©ìœ í˜•ë³„ ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜ê°€ ê°€ì¥ ë§ì€ ê±¸ë¡œ) í˜¹ì€ ê°€ì¤‘ì¹˜ 


- ì„ëŒ€ë³´ì¦ê¸ˆ - ì•ˆì”€ (ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜ * ì„ëŒ€ë³´ì¦ê¸ˆ / ì´ì„¸ëŒ€ìˆ˜ë¡œ?)


- ì„ëŒ€ë£Œ - ì•ˆì”€ (ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜ * ì„ëŒ€ë£Œ / ì´ì„¸ëŒ€ìˆ˜ë¡œ?)


- ì›-í•« ì¸ì½”ë”©ì‹œ train, test ëª¨ë‘ ì»¬ëŸ¼ìˆ˜ê°€ ë™ì¼í•´ì•¼í•œë‹¤.


- trainë§Œ ìˆëŠ” ë°ì´í„°ë¼ê±°ë‚˜ testë§Œ ìˆëŠ” ë°ì´í„°ë¥¼ ì†ë´ì•¼í•¨


```python
# ë‹¨ì§€ì½”ë“œ ë ˆë²¨
level = train_df["ë‹¨ì§€ì½”ë“œ"].nunique()
level
```




    423



- trainì˜ ê²½ìš° ë‹¨ì§€ì½”ë“œì˜ ì¤‘ë³µì„ ì œê±°í•˜ë©´ 423ìœ¼ë¡œ ë‚˜íƒ€ë‚¬ë‹¤.


```python
train_coldup = train_df.groupby(["ë‹¨ì§€ì½”ë“œ"]).nunique()
train_coldup_cnt = train_coldup.sum()
train_coldup_cnt
```




    ì´ì„¸ëŒ€ìˆ˜         423
    ì„ëŒ€ê±´ë¬¼êµ¬ë¶„       456
    ì§€ì—­           423
    ê³µê¸‰ìœ í˜•         488
    ì „ìš©ë©´ì         1898
    ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜    2230
    ê³µê°€ìˆ˜          423
    ìê²©ìœ í˜•         510
    ì„ëŒ€ë³´ì¦ê¸ˆ       1277
    ì„ëŒ€ë£Œ         1289
    ì§€í•˜ì² ìˆ˜         423
    ë²„ìŠ¤ìˆ˜          423
    ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜      423
    ë“±ë¡ì°¨ëŸ‰ìˆ˜        423
    dtype: int64



- ë‹¨ì§€ì½”ë“œë³„ë¡œ ì¤‘ë³µì´ ì—†ëŠ” ì´ì„¸ëŒ€ìˆ˜, ì§€ì—­, ê³µê°€ìˆ˜, ì§€í•˜ì² ìˆ˜, ë²„ìŠ¤ìˆ˜, ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜, ë“±ë¡ì°¨ëŸ‰ìˆ˜ëŠ” ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê¸°ë¡œ í–ˆë‹¤.


```python
# ë‹¨ì§€ì½”ë“œ ë ˆë²¨
level = train_df["ë‹¨ì§€ì½”ë“œ"].nunique()

# ì¤‘ë³µ ì—†ëŠ” ì»¬ëŸ¼
no_dup_col = train_coldup_cnt[train_coldup_cnt == level].index.values

# ì¤‘ë³µ ìˆëŠ” ì»¬ëŸ¼
dup_col = train_coldup_cnt[train_coldup_cnt != level].index.values

# ë‹¨ì§€ì½”ë“œ ë ˆë²¨ì˜ ë°ì´í„° ë¼ˆëŒ€
new_train = train_df.drop_duplicates(no_dup_col).set_index("ë‹¨ì§€ì½”ë“œ")[no_dup_col]
new_train = pd.get_dummies(new_train.sort_index())
new_train.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <th>ê³µê°€ìˆ˜</th>
      <th>ì§€í•˜ì² ìˆ˜</th>
      <th>ë²„ìŠ¤ìˆ˜</th>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
      <th>ë“±ë¡ì°¨ëŸ‰ìˆ˜</th>
      <th>ì§€ì—­_ê°•ì›ë„</th>
      <th>ì§€ì—­_ê²½ê¸°ë„</th>
      <th>ì§€ì—­_ê²½ìƒë‚¨ë„</th>
      <th>ì§€ì—­_ê²½ìƒë¶ë„</th>
      <th>ì§€ì—­_ê´‘ì£¼ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€êµ¬ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€ì „ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ë¶€ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì„œìš¸íŠ¹ë³„ì‹œ</th>
      <th>ì§€ì—­_ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ</th>
      <th>ì§€ì—­_ìš¸ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì „ë¼ë‚¨ë„</th>
      <th>ì§€ì—­_ì „ë¼ë¶ë„</th>
      <th>ì§€ì—­_ì œì£¼íŠ¹ë³„ìì¹˜ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë‚¨ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë¶ë„</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>566</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>438.0</td>
      <td>481.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>521</td>
      <td>3.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>153.0</td>
      <td>93.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>1144</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>950.0</td>
      <td>376.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>1308</td>
      <td>16.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>1119.0</td>
      <td>1665.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>996</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>823.0</td>
      <td>708.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



- ì•ì„œ trainì„ í™•ì¸í•œ ì½”ë“œëŠ” testì— ì ìš©ì‹œ ì¤‘ë³µì´ ì—†ëŠ” ì»¬ëŸ¼ì€ ë™ì¼í•˜ì—¬ ì´ë¥¼ í•¨ìˆ˜ë¡œ ë‚˜ì¤‘ì— ìƒì„±í•˜ê¸°ë¡œ ìƒê°í–ˆë‹¤.


- ì¶”ê°€ë¡œ testì˜ ì§€ì—­ì„ í™•ì¸í•˜ì˜€ì„ ë•Œ ì„œìš¸íŠ¹ë³„ì‹œê°€ ì—†ì–´ ì› í•« ì¸ì½”ë”©ì„ ì–´ë–»ê²Œ í• ì§€ë„ ê³ ë¯¼í•´ì•¼í–ˆë‹¤.


- ë‹¨ìˆœíˆ `pd.get_dummies()`ë¥¼ ì‚¬ìš©í•˜ë©´ trainê³¼ testì˜ êµ¬ì¡°ê°€ ë‹¬ë¼ì§€ê¸° ë•Œë¬¸ì—..

### 1.3.1 ì„ëŒ€ê±´ë¬¼êµ¬ë¶„


```python
print(train_df["ì„ëŒ€ê±´ë¬¼êµ¬ë¶„"].unique())
print(test_df["ì„ëŒ€ê±´ë¬¼êµ¬ë¶„"].unique())
```

    ['ì•„íŒŒíŠ¸' 'ìƒê°€']
    ['ì•„íŒŒíŠ¸' 'ìƒê°€']
    

- ì²« ë²ˆì§¸ë¡œ ì¤‘ë³µì´ ìˆëŠ” ì„ëŒ€ê±´ë¬¼êµ¬ë¶„ì€ ì•„íŒŒíŠ¸ì™€ ìƒê°€ 2ê°œì˜ ê°’ì„ ê°€ì§€ê³  ìˆë‹¤.


```python
# ì•„íŒŒíŠ¸, ìƒê°€, ì£¼ìƒë³µí•©ìœ¼ë¡œ ë¶„ë¦¬
def rental_class_apply(x):
    if (x["ì•„íŒŒíŠ¸"] > 0) & (x["ìƒê°€"] > 0): return "ì£¼ìƒë³µí•©"
    
    elif x["ì•„íŒŒíŠ¸"] > 0: return "ì•„íŒŒíŠ¸"
    
    else: return "ìƒê°€"

def rental_class(df):
    # ë‹¨ì§€ì½”ë“œ, ì„ëŒ€ê±´ë¬¼êµ¬ë¶„ë³„ count (ê°’ìœ¼ë¡œëŠ” ë‹¨ì§€ì½”ë“œë³„ë¡œ ê°™ì€ ê°’ì„ ê°€ì§€ëŠ” ì´ì„¸ëŒ€ìˆ˜ ì‚¬ìš© í° ì˜ë¯¸ ì—†ìŒ)
    temp = df.pivot_table("ì´ì„¸ëŒ€ìˆ˜", "ë‹¨ì§€ì½”ë“œ", "ì„ëŒ€ê±´ë¬¼êµ¬ë¶„", aggfunc="count").fillna(0)
    
    # ì•„íŒŒíŠ¸, ìƒê°€, ì£¼ìƒë³µí•©ìœ¼ë¡œ ë¶„ë¦¬
    temp["ê±´ë¬¼"] = temp.apply(lambda x: rental_class_apply(x), axis=1)
    
    # ì›-í•« ì¸ì½”ë”©
    rental =pd.get_dummies(temp[["ê±´ë¬¼"]])
    
    return rental

rental_class(train_df).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ê±´ë¬¼_ì•„íŒŒíŠ¸</th>
      <th>ê±´ë¬¼_ì£¼ìƒë³µí•©</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



- ì›ë˜ëŠ” ì•„íŒŒíŠ¸, ìƒê°€, ì£¼ìƒë³µí•©(ì•„íŒŒíŠ¸, ìƒê°€ê°€ ê°™ì´ ìˆëŠ” ê²½ìš°)ë¡œ êµ¬ë¶„í•˜ë ¤ í•˜ì˜€ë‹¤.


- í™•ì¸í•´ë³´ë‹ˆ ìƒê°€ë¥¼ ê°€ì§„ ë‹¨ì§€ì½”ë“œëŠ” ì•„íŒŒíŠ¸ë„ ë¬´ì¡°ê±´ ê°€ì§€ê³  ìˆì—ˆë‹¤.


- ìƒê°í•´ë³´ë©´ ì• ì´ˆì— ì•„íŒŒíŠ¸ ë‹¨ì§€ì½”ë“œë³„ë¡œ ì£¼ì°¨ìˆ˜ìš”ë¥¼ ì˜ˆì¸¡í•˜ëŠ”ë° ì•„íŒŒíŠ¸ê°€ ì—†ëŠ”ê²Œ ë§ì´ ì•ˆë˜ì§€ ì‹¶ì—ˆë‹¤...

### 1.3.2 ì „ìš©ë©´ì , ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜


```python
def area(df):
    # ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
    temp = df.set_index("ë‹¨ì§€ì½”ë“œ")["ì „ìš©ë©´ì "]//5*5
    
    # ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
    temp[temp<15] = 15
    temp[temp>100]= 100
    
    return temp
    
print(np.sort(area(train_df).unique()))
print(np.sort(area(test_df).unique()))
```

    [ 15.  20.  25.  30.  35.  40.  45.  50.  55.  60.  65.  70.  75.  80.
     100.]
    [ 15.  20.  25.  30.  35.  40.  45.  50.  55.  60.  70.  75.  80. 100.]
    

- ìœ„ ì½”ë“œëŠ” ë°ì´ì½˜ ë² ì´ìŠ¤ë¼ì¸ì—ì„œ ì „ìš©ë©´ì ê³¼ ì „ìš©ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ë¥¼ ì „ì²˜ë¦¬í•œ ê²ƒì„ í™•ì¸í•´ë³´ë ¤ê³  ë§Œë“¤ì—ˆë‹¤.


- ë² ì´ìŠ¤ë¼ì¸ì€ ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ êµ¬ê°„ìœ¼ë¡œ ë³€ê²½í•˜ì˜€ê³  í™•ì¸í•´ë³´ë‹ˆ testì—ëŠ” 65 êµ¬ê°„ì´ ì—†ì—ˆë‹¤.


- ì´ì— ëŒ€í•´ì„œ êµ¬ê°„ì€ ë™ì¼í•˜ê²Œ í•˜ë˜ ì—¬ëŸ¬ ë°©ë²•ì„ ìƒê°í•´ë³´ì•˜ë‹¤.

**[ë°©ë²• 1]**


```python
def area(df):
    # ì „ìš©ë©´ì  15~105ê¹Œì§€ 10ë‹¨ìœ„ë¡œ 9ê°œ êµ¬ê°„ ìƒì„±
    bins = list(range(14,105,10))
    labels = [f"ë©´ì _{bins[i]+1}_{bins[i]+6}" for i in range(len(bins)-1)]

    # ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
    temp = df.set_index("ë‹¨ì§€ì½”ë“œ")["ì „ìš©ë©´ì "]//5*5
    
    # ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
    temp[temp<15] = 15
    temp[temp>100]= 100
    
    # ë©´ì êµ¬ê°„ ì¶”ê°€
    temp2 = temp.reset_index()
    temp2["ë©´ì êµ¬ê°„"] = pd.cut(temp2["ì „ìš©ë©´ì "], bins, labels=labels)
    
    # ë‹¨ì§€ì½”ë“œë³„ ë©´ì êµ¬ê°„ ì¤‘ë³µ ì œê±°
    temp3 = temp2.drop("ì „ìš©ë©´ì ", axis=1)
    temp3 = temp3.drop_duplicates()
    
    # ë©´ì êµ¬ê°„ì„ ì»¬ëŸ¼ìœ¼ë¡œ í• ë‹¹í•˜ì—¬ ì›-í•« ì¸ì½”ë”© í˜•íƒœë¡œ ìƒì„±
    temp4 = temp3.assign(a=1)
    temp4 = temp4.pivot("ë‹¨ì§€ì½”ë“œ","ë©´ì êµ¬ê°„","a").fillna(0)
    
    # train, test ëª¨ë‘ ì—†ëŠ” "ë©´ì _85_90" êµ¬ê°„ ì‚­ì œ, ì»¬ëŸ¼ ì •ë ¬
    labels.pop(-2)
    
    return temp4[labels]

area(train_df).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ë©´ì êµ¬ê°„</th>
      <th>ë©´ì _15_20</th>
      <th>ë©´ì _25_30</th>
      <th>ë©´ì _35_40</th>
      <th>ë©´ì _45_50</th>
      <th>ë©´ì _55_60</th>
      <th>ë©´ì _65_70</th>
      <th>ë©´ì _75_80</th>
      <th>ë©´ì _95_100</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



- ë°©ë²•1ì€ trainê³¼ testì˜ í”¼ì²˜ìˆ˜ê°€ ë™ì¼í•˜ê²Œë” êµ¬ê°„ì„ 10ë‹¨ìœ„ë¡œ ì„¤ì •í•˜ì˜€ë‹¤.


- ê·¸ë¦¬ê³  ë‹¨ì§€ë³„ë¡œ íŠ¹ì • ë©´ì êµ¬ê°„ì´ ì¡´ì¬í•œë‹¤ëŠ” ì˜ë¯¸ë¡œ ì›-í•« ì¸ì½”ë”©ì„ ì‹¤í–‰í•˜ì˜€ë‹¤.

**[ë°©ë²• 2]**


```python
def area2(df):
    # ì „ìš©ë©´ì  15~105ê¹Œì§€ 10ë‹¨ìœ„ë¡œ 9ê°œ êµ¬ê°„ ìƒì„±
    bins = list(range(14,105,10))
    labels = [f"ë©´ì _{bins[i]+1}_{bins[i]+6}" for i in range(len(bins)-1)]

    # ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
    temp = df.set_index("ë‹¨ì§€ì½”ë“œ")["ì „ìš©ë©´ì "]//5*5
    
    # ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
    temp[temp<15] = 15
    temp[temp>100]= 100
    
    # ë©´ì êµ¬ê°„ ì¶”ê°€
    temp2 = temp.reset_index()
    temp2["ë©´ì êµ¬ê°„"] = pd.cut(temp2["ì „ìš©ë©´ì "], bins, labels=labels)
    temp2["ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜"] = df["ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜"]
    
    # ë‹¨ì§€ì½”ë“œ, ë©´ì êµ¬ê°„ë³„ ì„¸ëŒ€ìˆ˜ í•©
    temp3 = temp2.pivot_table("ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜","ë‹¨ì§€ì½”ë“œ","ë©´ì êµ¬ê°„",aggfunc="sum").fillna(0)
    
    # train, test ëª¨ë‘ ì—†ëŠ” "ë©´ì _85_90" êµ¬ê°„ ì‚­ì œ, ì»¬ëŸ¼ ì •ë ¬
    labels.pop(-2)
    
    return temp3[labels]

area2(train_df).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ë©´ì êµ¬ê°„</th>
      <th>ë©´ì _15_20</th>
      <th>ë©´ì _25_30</th>
      <th>ë©´ì _35_40</th>
      <th>ë©´ì _45_50</th>
      <th>ë©´ì _55_60</th>
      <th>ë©´ì _65_70</th>
      <th>ë©´ì _75_80</th>
      <th>ë©´ì _95_100</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>419.0</td>
      <td>147.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>10.0</td>
      <td>3.0</td>
      <td>506.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>904.0</td>
      <td>240.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>291.0</td>
      <td>1017.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>0.0</td>
      <td>516.0</td>
      <td>0.0</td>
      <td>396.0</td>
      <td>84.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



- ë°©ë²•2 ì—­ì‹œ trainê³¼ testì˜ í”¼ì²˜ìˆ˜ê°€ ë™ì¼í•˜ê²Œë” êµ¬ê°„ì„ ì„¤ì •í•´ 10ë‹¨ìœ„ë¡œ ë¬¶ì—ˆë‹¤.


- ê·¸ë¦¬ê³  ë‹¨ì§€ë³„ë¡œ íŠ¹ì • ë©´ì êµ¬ê°„ì˜ ì„¸ëŒ€ìˆ˜ë¥¼ í•©í•˜ì˜€ë‹¤.


- ì´ ê²½ìš° ì¶”í›„ í•™ìŠµí•  ë•Œ ë‹¤ì¤‘ê³µì„ ì„± ë•Œë¬¸ì— ì´ ì„¸ëŒ€ìˆ˜ëŠ” ë„£ìœ¼ë©´ ì•ˆë  ê²ƒ ê°™ë‹¤ê³  ìƒê°í•˜ì˜€ë‹¤.


```python
# ì´ ì„¸ëŒ€ìˆ˜ì™€ ì „ìš©ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ í•©ì´ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤.
b = area2(train_df).sum(axis=1) - new_train.ì´ì„¸ëŒ€ìˆ˜
len(b[b!=0])
```




    40



- ì´ ê³¼ì •ì—ì„œ ì´ ì„¸ëŒ€ìˆ˜ì™€ ì „ìš©ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ í•©ì´ ì¼ì¹˜ í•˜ì§€ ì•ŠëŠ” ê²ƒì„ í™•ì¸í–ˆë‹¤.


- ê²°ë¡ ë¶€í„° ë§í•˜ë©´ ì¶”í›„ ë°ì´ì½˜ì—ì„œ ë‹´ë‹¹ìì™€ í™•ì¸í•´ ì´ ë¶€ë¶„ì€ ì˜¤ë¥˜ë¼ê³  ê°ì•ˆí•˜ë¼ê³  í•˜ì˜€ë‹¤..;

**[ë°©ë²• 3]**


```python
temp = train_df["ì „ìš©ë©´ì "]//5*5
    
# ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
temp[temp<15] = 15
temp[temp>100]= 100

unique_col = np.sort(temp.unique())
unique_col
```




    array([ 15.,  20.,  25.,  30.,  35.,  40.,  45.,  50.,  55.,  60.,  65.,
            70.,  75.,  80., 100.])



- ë‹¤ìŒìœ¼ë¡  êµ¬ê°„ì„ 5ë¡œ í•˜ë˜ trainì´ testë³´ë‹¤ levelì´ ë§ìœ¼ë¯€ë¡œ train ê¸°ì¤€ìœ¼ë¡œ ì „ìš©ë©´ì  ë ˆë²¨ì„ ì¶”ì¶œí•œë‹¤.


```python
def area3(df):
    # ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
    temp = df.set_index("ë‹¨ì§€ì½”ë“œ")["ì „ìš©ë©´ì "]//5*5
    
    # ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
    temp[temp<15] = 15
    temp[temp>100]= 100
    
    # ë‹¨ì§€ì½”ë“œë³„ ì „ìš©ë©´ì  (ì¤‘ë³µ ì œê±°)
    temp2 = temp.reset_index().drop_duplicates()
    
    # ì „ìš©ë©´ì  ê°’ì„ ì»¬ëŸ¼ìœ¼ë¡œ ì‚¬ìš©    
    temp2[unique_col] = 0
    
    # ì›-í•« ì¸ì½”ë”© (ì „ìš©ë©´ì ê°’ê³¼ ì»¬ëŸ¼ê°’ì´ ë™ì¼í•˜ë©´ í•´ë‹¹ ì»¬ëŸ¼ì— 1ì„ ë¶€ì—¬)
    for value in unique_col:
        col_idx = temp2["ì „ìš©ë©´ì "] == value
        temp2.loc[col_idx, value] = 1
    
    temp2.drop("ì „ìš©ë©´ì ", inplace=True, axis=1)
    temp3 = temp2.groupby("ë‹¨ì§€ì½”ë“œ").sum()
    
    # ì»¬ëŸ¼ëª… ìˆ˜ì •
    col_name = [f"ë©´ì _{i}" for i in temp3.columns]
    temp3.columns = col_name
    
    return temp3

area3(train_df).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ë©´ì _15.0</th>
      <th>ë©´ì _20.0</th>
      <th>ë©´ì _25.0</th>
      <th>ë©´ì _30.0</th>
      <th>ë©´ì _35.0</th>
      <th>ë©´ì _40.0</th>
      <th>ë©´ì _45.0</th>
      <th>ë©´ì _50.0</th>
      <th>ë©´ì _55.0</th>
      <th>ë©´ì _60.0</th>
      <th>ë©´ì _65.0</th>
      <th>ë©´ì _70.0</th>
      <th>ë©´ì _75.0</th>
      <th>ë©´ì _80.0</th>
      <th>ë©´ì _100.0</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



- ë°©ë²•3ì€ ë©´ì  ì»¬ëŸ¼ì„ ë² ì´ìŠ¤ë¼ì¸ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •í•˜ì§€ë§Œ ë°©ë²•1ì²˜ëŸ¼ ì›-í•« ì¸ì½”ë”© ë°©ì‹ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.


- testëŠ” 65ê°€ ì—†ì–´ ëª¨ë‘ 0ìœ¼ë¡œ ë“¤ì–´ê°€ê²Œë” ì›-í•« ì¸ì½”ë”©ì„ `pd.get_dummies()` ëŒ€ì‹  ì§ì ‘ ì‘ì„±í•˜ì˜€ë‹¤.

**[ë°©ë²• 4]**


```python
def area4(df):
    # ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
    temp = df.set_index("ë‹¨ì§€ì½”ë“œ")["ì „ìš©ë©´ì "]//5*5
    
    # ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
    temp[temp<15] = 15
    temp[temp>100]= 100
    
    # ë‹¨ì§€ì½”ë“œë³„ ì „ìš©ë©´ì 
    temp2 = temp.reset_index()
    temp2["ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜"] = df["ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜"]
    
    # ë‹¨ì§€ì½”ë“œ, ì „ìš©ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ í•©
    temp3 = temp2.pivot_table("ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜","ë‹¨ì§€ì½”ë“œ","ì „ìš©ë©´ì ",aggfunc="sum").fillna(0)
    
    # ë§Œì•½ unique_colì—ë§Œ ì¡´ì¬í•˜ëŠ” ì»¬ëŸ¼ì´ ìˆìœ¼ë©´ ê°’ 0ìœ¼ë¡œ ì»¬ëŸ¼ ì¶”ê°€
    extra_col = list(set(unique_col) - set(temp3.columns.values))
    temp3[extra_col] = 0
    temp4 = temp3[unique_col]
    
    # ì»¬ëŸ¼ëª… ìˆ˜ì •
    col_name = [f"ë©´ì _{i}" for i in temp4.columns]
    temp4.columns = col_name
    
    return temp4

area4(train_df).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ë©´ì _15.0</th>
      <th>ë©´ì _20.0</th>
      <th>ë©´ì _25.0</th>
      <th>ë©´ì _30.0</th>
      <th>ë©´ì _35.0</th>
      <th>ë©´ì _40.0</th>
      <th>ë©´ì _45.0</th>
      <th>ë©´ì _50.0</th>
      <th>ë©´ì _55.0</th>
      <th>ë©´ì _60.0</th>
      <th>ë©´ì _65.0</th>
      <th>ë©´ì _70.0</th>
      <th>ë©´ì _75.0</th>
      <th>ë©´ì _80.0</th>
      <th>ë©´ì _100.0</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>419.0</td>
      <td>0.0</td>
      <td>72.0</td>
      <td>75.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>3.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>506.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>904.0</td>
      <td>240.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>291.0</td>
      <td>0.0</td>
      <td>757.0</td>
      <td>260.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>516.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>280.0</td>
      <td>116.0</td>
      <td>84.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



- ë°©ë²•4ëŠ” ë°©ë²•2ì™€ ë°©ë²•3ì˜ í˜¼í•© ë²„ì „ìœ¼ë¡œ ì „ìš©ë©´ì  êµ¬ê°„ë³„(5ë‹¨ìœ„)ë¡œ ì„¸ëŒ€ìˆ˜ì˜ í•©ê³„ë¥¼ êµ¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì „ì²˜ë¦¬ í•˜ì˜€ë‹¤.


- ì‚¬ì‹¤ ì´ ë•Œ ëª°ëëŠ”ë° ê²°ê³¼ë¬¼ì´ ë² ì´ìŠ¤ë¼ì¸ê³¼ ì™„ì „ ë™ì¼í•˜ì˜€ë‹¤.


- ë² ì´ìŠ¤ë¼ì¸ì„ ì°¸ê³ í•˜ë”ë¼ë„ ì½”ë“œëŠ” ì§ì ‘ ë§Œë“ ë‹¤ëŠ” ìƒê°ì— ë² ì´ìŠ¤ë¼ì¸ì˜ êµ¬ê°„ ì•„ì´ë””ì–´ë§Œ ì°¸ê³ í–ˆëŠ”ë° ë˜‘ê°™ì´ ë§Œë“¤ê²Œ ë˜ì—ˆë‹¤.


- ê²°ê³¼ë¬¼ì´ ë˜‘ê°™ìœ¼ë‹ˆ ì‹œê°„ ë‚ ë ¸ë‚˜ ì‹¶ì—ˆëŠ”ë° ì§ì ‘ ê³ ë¯¼í•˜ê³  ë§Œë“ ê²Œ ë” ì˜ë¯¸ê°€ ìˆì§€ ì•Šì„ê¹Œë¼ê³  ìƒê°í•œë‹¤...

### 1.3.3 ê³µê¸‰ìœ í˜•


```python
train_df["ê³µê¸‰ìœ í˜•"].value_counts()
```




    êµ­ë¯¼ì„ëŒ€         1758
    ì„ëŒ€ìƒê°€          562
    í–‰ë³µì£¼íƒ          213
    ê³µê³µì„ëŒ€(10ë…„)     205
    ì˜êµ¬ì„ëŒ€          152
    ê³µê³µì„ëŒ€(50ë…„)      31
    ê³µê³µì„ëŒ€(ë¶„ë‚©)       12
    ì¥ê¸°ì „ì„¸            9
    ê³µê³µë¶„ì–‘            7
    ê³µê³µì„ëŒ€(5ë…„)        3
    Name: ê³µê¸‰ìœ í˜•, dtype: int64




```python
test_df["ê³µê¸‰ìœ í˜•"].value_counts()
```




    êµ­ë¯¼ì„ëŒ€         622
    ì„ëŒ€ìƒê°€         177
    í–‰ë³µì£¼íƒ         124
    ì˜êµ¬ì„ëŒ€          45
    ê³µê³µì„ëŒ€(10ë…„)     35
    ê³µê³µì„ëŒ€(50ë…„)     13
    ê³µê³µì„ëŒ€(ë¶„ë‚©)       6
    Name: ê³µê¸‰ìœ í˜•, dtype: int64




```python
set(train_df["ê³µê¸‰ìœ í˜•"].unique()) - set(test_df["ê³µê¸‰ìœ í˜•"].unique())
```




    {'ê³µê³µë¶„ì–‘', 'ê³µê³µì„ëŒ€(5ë…„)', 'ì¥ê¸°ì „ì„¸'}



- trainì—ëŠ” ê³µê³µë¶„ì–‘, ê³µê³µì„ëŒ€(5ë…„), ì¥ê¸°ì „ì„¸ê°€ ìˆìœ¼ë‚˜ testëŠ” ì—†ì—ˆë‹¤.


- ì„œìš¸ì£¼íƒë„ì‹œê³µì‚¬ì—ì„œ ì„ëŒ€ì£¼íƒ ê³µê¸‰ìœ í˜•ì„ í™•ì¸í•˜ì˜€ë‹¤.


- ì´ë¥¼ ë³´ê³  ìš°ì„  ê³µê³µì„ëŒ€ë“¤ì´ë‘ ê³µê³µë¶„ì–‘ì€ ê³µê³µì„ëŒ€ë¡œ ë¬¶ìœ¼ë©´ ë  ê²ƒ ê°™ë‹¤ ìƒê°í•˜ì˜€ë‹¤.


- ì¥ê¸°ì „ì„¸ëŠ” ì¤‘ì‚°ì¸µì´ë¯€ë¡œ ê·¸ë‚˜ë§ˆ ì„±ê²©ì´ ê°€ê¹Œì›Œë³´ì´ëŠ” ì„œë¯¼ì¸µì¸ êµ­ë¯¼ì„ëŒ€ë‘ ë¬¶ê¸°ë¡œ í•˜ì˜€ë‹¤..


```python
def supply_apply(x):
    if (x == "êµ­ë¯¼ì„ëŒ€") | (x == "ì¥ê¸°ì „ì„¸"):
        return "êµ­ë¯¼ì„ëŒ€/ì¥ê¸°ì „ì„¸"
    elif x.startswith("ê³µê³µ"):
        return "ê³µê³µì„ëŒ€/ë¶„ì–‘"
    else:
        return x
    
def supply(df):
    temp = df[["ë‹¨ì§€ì½”ë“œ"]]
    temp["ê³µê¸‰ìœ í˜•"] = df["ê³µê¸‰ìœ í˜•"].apply(lambda x: supply_apply(x))
    
    temp2 = temp.drop_duplicates().assign(temp_var=1)
    temp3 = temp2.pivot_table("temp_var","ë‹¨ì§€ì½”ë“œ","ê³µê¸‰ìœ í˜•",aggfunc="count").fillna(0)
    
    return temp3

supply(train_df).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ê³µê¸‰ìœ í˜•</th>
      <th>ê³µê³µì„ëŒ€/ë¶„ì–‘</th>
      <th>êµ­ë¯¼ì„ëŒ€/ì¥ê¸°ì „ì„¸</th>
      <th>ì˜êµ¬ì„ëŒ€</th>
      <th>ì„ëŒ€ìƒê°€</th>
      <th>í–‰ë³µì£¼íƒ</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>



- ì•ì„œ ì§€ì—­ì´ë‚˜ ì „ìš©ë©´ì ì˜ ë°©ë²•3,4 ì²˜ëŸ¼ testì— ì—†ìœ¼ë©´ ëª¨ë‘ 0ìœ¼ë¡œ ë¶€ì—¬í• ê¹Œë„ ì‹¶ì—ˆë‹¤.


- ì´ ë¶€ë¶„ì€ ì„œìš¸ì£¼íƒê³µì‚¬ë‚˜ ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜ ì˜ê²¬ê³µìœ ì—ì„œ ë¬¶ëŠ”ê²Œ ì¢‹ì•„ë³´ì—¬ ì´ë ‡ê²Œ ê²°ì •í•˜ì˜€ë‹¤.

### 1.3.4 ìê²©ìœ í˜•


```python
train_df["ìê²©ìœ í˜•"].unique()
```




    array(['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',
           'N', 'O'], dtype=object)




```python
test_df["ìê²©ìœ í˜•"].unique()
```




    array(['H', 'A', 'E', 'C', 'D', 'G', 'I', 'J', 'K', 'L', 'M', 'N'],
          dtype=object)




```python
set(train_df["ìê²©ìœ í˜•"].unique()) - set(test_df["ìê²©ìœ í˜•"].unique())
```




    {'B', 'F', 'O'}



- ì—­ì‹œë‚˜ trainì—ë§Œ ì¡´ì¬í•˜ëŠ” ìê²©ìœ í˜•ì´ ìˆì—ˆë‹¤.


```python
unique_col2 = train_df["ìê²©ìœ í˜•"].unique()
unique_col2
```




    array(['A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M',
           'N', 'O'], dtype=object)



- ì´ ë¶€ë¶„ì— ëŒ€í•´ì„  ì–´ë–»ê²Œ ë¬¶ì–´ì•¼ í• ì§€ ëª¨ë¥´ê² ì–´ testì˜ B, F, OëŠ” 0ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸°ë¡œ í•˜ì˜€ë‹¤.


```python
def qualification(df):
    temp = df[["ë‹¨ì§€ì½”ë“œ","ìê²©ìœ í˜•"]]
    temp = temp.drop_duplicates()

    temp[unique_col2]=0
    
    # ì›-í•« ì¸ì½”ë”© (ìê²©ìœ í˜•ê°’ê³¼ ì»¬ëŸ¼ê°’ì´ ë™ì¼í•˜ë©´ í•´ë‹¹ ì»¬ëŸ¼ì— 1ì„ ë¶€ì—¬)
    for value in unique_col2:
        col_idx = temp["ìê²©ìœ í˜•"] == value
        temp.loc[col_idx, value] = 1

    temp.drop("ìê²©ìœ í˜•", inplace=True, axis=1)
    temp2 = temp.groupby("ë‹¨ì§€ì½”ë“œ").sum()
    
    # ì»¬ëŸ¼ëª… ìˆ˜ì •
    col_name = [f"ìê²©_{i}" for i in temp2.columns]
    temp2.columns = col_name
    
    return temp2

qualification(train_df).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ìê²©_A</th>
      <th>ìê²©_B</th>
      <th>ìê²©_C</th>
      <th>ìê²©_D</th>
      <th>ìê²©_E</th>
      <th>ìê²©_F</th>
      <th>ìê²©_G</th>
      <th>ìê²©_H</th>
      <th>ìê²©_I</th>
      <th>ìê²©_J</th>
      <th>ìê²©_K</th>
      <th>ìê²©_L</th>
      <th>ìê²©_M</th>
      <th>ìê²©_N</th>
      <th>ìê²©_O</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1004</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1005</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1013</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C1014</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



- ì—¬ê¸°ê¹Œì§€ ë‹¨ì§€ì½”ë“œ ë ˆë²¨ë¡œ ë§Œë“¤ê¸° ìœ„í•œ ì‚¬ì „ ì‘ì—…ì´ ì–´ëŠ ì •ë„ ëë‚¬ë‹¤.


- ë‚¨ì€ ê²ƒì€ ì œê³µë°›ì€ ë°ì´í„° ì¤‘ age_gender_infoë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ë‹¨ ê²ƒê³¼ 1.3.2ì—ì„œ í™•ì¸í•œ ì˜¤ë¥˜ ë“±ì´ ìˆì—ˆë‹¤.

## 1.4 ìµœì¢… ì „ì²˜ë¦¬

1.1 ~ 1.3ê¹Œì§€ ì´ˆê¸°ì— ë°ì´í„°ë¥¼ ë³´ê³  ìƒê°í•œ ì  ìœ„ì£¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤. ë‹¤ë§Œ ëŒ€íšŒë¥¼ ì§„í–‰í•˜ë©´ì„œ ì—¬ëŸ¬ ì˜¤ë¥˜ë“¤ì´ ë°œìƒë˜ì–´ ì—¬ëŸ¬ ìˆ˜ì •ì‚¬í•­ì´ ë°œìƒí•˜ì˜€ë‹¤. ë‚´ê°€ ë°œê²¬í•œ ì˜¤ë¥˜ ì™¸ì—ë„ ì•„ë˜ì™€ ê°™ì€ ì‚¬í•­ì´ ìˆì—ˆë‹¤.

1. ì „ìš©ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ í•©ê³„ì™€ ì´ì„¸ëŒ€ìˆ˜ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš°


2. ë™ì¼í•œ ë‹¨ì§€ì— ë‹¨ì§€ì½”ë“œê°€ 2ê°œë¡œ ë¶€ì—¬ëœê²½ìš°


3. ë‹¨ì§€ì½”ë“œ ë“± ê¸°ì… ì‹¤ìˆ˜ë¡œ ë°ì´í„° ì •ì œ ê³¼ì •ì—ì„œ ë§¤ì¹­ ì˜¤ë¥˜ ë°œìƒ

ìì„¸í•œ ì‚¬í•­ì€ [ì—¬ê¸°](https://dacon.io/competitions/official/235745/talkboard/403708?page=1&dtype=recent)ë¥¼ ëˆŒëŸ¬ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.

ì•„ë¬´íŠ¼ ì´ëŸ¬í•œ ì˜¤ë¥˜ ë•Œë¬¸ì— ì „ì²˜ë¦¬ë„ ìˆ˜ì •í•˜ì˜€ê³  ë°ì´ì½˜ì—ì„  1ë²ˆ ì˜¤ë¥˜ëŠ” ê°ì•ˆí•˜ê³  2,3ë²ˆ ì˜¤ë¥˜ì— í•´ë‹¹í•˜ëŠ” ë‹¨ì§€ì½”ë“œëŠ” ì œê±°í•˜ê¸¸ ê¶Œìœ í•˜ì˜€ëŠ”ë° 3ë²ˆ ì˜¤ë¥˜ëŠ” ë„ì €íˆ ëŒ€ì²´ê°€ ë¶ˆê°€ëŠ¥í•´ ë³´ì˜€ê³  ì•ˆê·¸ë˜ë„ ë‹¨ì§€ì½”ë“œ ë ˆë²¨ì´ 420ê°œ ê°€ëŸ‰ì¸ë° ë‹¨ì§€ ì½”ë“œë¥¼ ì œê±°í•˜ë©´ ë°ì´í„°ê°€ ë„ˆë¬´ ì ì€ ê²ƒ ê°™ì•„ 1,2ë²ˆì€ ìˆ˜ì •í•˜ëŠ” ë°©í–¥ìœ¼ë¡œ ì§„í–‰í•˜ì˜€ë‹¤. ì´ ê³¼ì •ì—ì„œ ë„ˆë¬´ ì—¬ëŸ¬ ë²„ì „ì´ ìˆì–´ ìµœì¢… ë²„ì „ê³¼ í•¨ê»˜ ì„¤ëª…ì„ ì ê³ ì í•œë‹¤.


```python
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
train_df = pd.read_csv('train.csv')
test_df = pd.read_csv('test.csv')
submission = pd.read_csv('sample_submission.csv')
age_gender_info = pd.read_csv('age_gender_info.csv')
```


```python
# ì»¬ëŸ¼ëª… ë³€ê²½
rename_col_lst = {"ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ì§€í•˜ì² ì—­ ìˆ˜(í™˜ìŠ¹ë…¸ì„  ìˆ˜ ë°˜ì˜)": "ì§€í•˜ì² ìˆ˜",
                  "ë„ë³´ 10ë¶„ê±°ë¦¬ ë‚´ ë²„ìŠ¤ì •ë¥˜ì¥ ìˆ˜": "ë²„ìŠ¤ìˆ˜"}

train_df.rename(columns = rename_col_lst, inplace=True)
test_df.rename(columns = rename_col_lst, inplace=True)
```


```python
# 2ë²ˆ ì˜¤ë¥˜ ìˆ˜ì •: ë™ì¼í•œ ë‹¨ì§€ì— ì½”ë“œê°€ 2ê°œë¡œ ë¶€ì—¬ëœ ë‹¨ì§€ ì½”ë“œ

# testì™€ ìŒì„ ì´ë£¨ëŠ” ê²½ìš°ê°€ ìˆì–´ trainì— í•´ë‹¹ ì •ë³´ ì¶”ê°€
temp = test_df[test_df["ë‹¨ì§€ì½”ë“œ"]=="C2675"]
temp["ë“±ë¡ì°¨ëŸ‰ìˆ˜"] = 1279
train_df = pd.concat([train_df, temp])
train_df = train_df.reset_index().drop(columns="index")

# ['C2085', 'C1397']
code = ['C2085', 'C1397']
# train_df[train_df["ë‹¨ì§€ì½”ë“œ"].isin(code)]
err_idx = train_df[train_df["ë‹¨ì§€ì½”ë“œ"].isin(code)].index.values

train_df.loc[err_idx, "ë‹¨ì§€ì½”ë“œ"] = "C1397"
train_df.loc[err_idx, "ì´ì„¸ëŒ€ìˆ˜"] = 1339
train_df.loc[err_idx, "ê³µê°€ìˆ˜"] = 9

# ['C2431', 'C1649']
code = ['C2431', 'C1649']
err_idx2 = train_df[train_df["ë‹¨ì§€ì½”ë“œ"].isin(code)].index.values

train_df.loc[err_idx2, "ë‹¨ì§€ì½”ë“œ"] = "C1649"
train_df.loc[err_idx2, "ì´ì„¸ëŒ€ìˆ˜"] = 1047
train_df.loc[err_idx2, "ê³µê°€ìˆ˜"] = 31
train_df.loc[err_idx2, "ì§€í•˜ì² ìˆ˜"] = 0
train_df.loc[err_idx2, "ë²„ìŠ¤ìˆ˜"] = 2
train_df.loc[err_idx2, "ë“±ë¡ì°¨ëŸ‰ìˆ˜"] = 1214

# ['C1036', 'C2675']
code = ['C1036', 'C2675'] 
err_idx3 = train_df[train_df["ë‹¨ì§€ì½”ë“œ"].isin(code)].index.values

train_df.loc[err_idx3, "ë‹¨ì§€ì½”ë“œ"] = "C1036"
train_df.loc[err_idx3, "ì´ì„¸ëŒ€ìˆ˜"] = 1254
train_df.loc[err_idx3, "ê³µê°€ìˆ˜"] = 22

# í™•ì¸
# code = ['C1397', 'C1649', 'C1036']
# train_df[train_df["ë‹¨ì§€ì½”ë“œ"].isin(code)].sort_values(by="ë‹¨ì§€ì½”ë“œ")
```

- 2ë²ˆ ì˜¤ë¥˜ì˜ ê²½ìš°ëŠ” ê°™ì€ ë‹¨ì§€ì½”ë“œì¸ë° ë‹¤ë¥¸ ì½”ë“œê°€ ë¶€ì—¬ëœ ê²½ìš°ì´ë¯€ë¡œ ì§ì ‘ ëœ¯ì–´ë³¸ í›„ì— ì˜¬ë°”ë¥´ê²Œ ìˆ˜ì •í•˜ì˜€ë‹¤.


- ë°ì´ì½˜ì—ì„œ ì´ì„¸ëŒ€ìˆ˜, ë“±ë¡ì°¨ëŸ‰ìˆ˜ ë“± ì˜¬ë°”ë¥¸ ê°’ì„ ì œê³µí•´ì£¼ì—ˆê³  ë‚˜ë¨¸ì§€ ë‹¤ë¥¸ ì ì€ uniqueí•œ ê°’ì„ í™•ì¸í•˜ì˜€ë‹¤.


- ì²˜ìŒì—ëŠ” 2ë²ˆ ì˜¤ë¥˜ë„ ì œê±°í•˜ê³  ëª¨ë¸ì„ ëŒë ¸ì—ˆëŠ”ë° ìµœì¢…ì ìœ¼ë¡  ë°ì´í„°ë¥¼ ìƒì§€ ì•Šê¸° ìœ„í•´ ìˆ˜ì •í•˜ì˜€ë‹¤.


```python
# train, test ì œì™¸ ë‹¨ì§€ì½”ë“œ
# train_err_code = ['C2085', 'C1397', 'C2431', 'C1649', 'C1036', 'C1095','C2051','C1218','C1894','C2483','C1502','C1988'] 

# train: 3ë²ˆ ì˜¤ë¥˜ ì‚­ì œ, test: 2ë²ˆ, 3ë²ˆ ì˜¤ë¥˜ ì‚­ì œ
train_err_code = ['C1095','C2051','C1218','C1894','C2483','C1502','C1988'] 
test_err_code = ['C2675','C2335','C1327']

# ë‹¨ì§€ì½”ë“œë¥¼ ì œì™¸í•œ ë°ì´í„°
train = train_df[~train_df["ë‹¨ì§€ì½”ë“œ"].isin(train_err_code)]
test = test_df[~test_df["ë‹¨ì§€ì½”ë“œ"].isin(test_err_code)]
```

- 3ë²ˆ ì˜¤ë¥˜ëŠ” ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ì—†ì–´ ì œê±°í•˜ì˜€ë‹¤.


```python
# ê²°ì¸¡ê°’ ëŒ€ì²´
# ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œ "-" ê°’, ê²°ì¸¡ê°’ 0 ìœ¼ë¡œ ëŒ€ì²´, intí˜•ìœ¼ë¡œ ë°”ê¾¸ê¸°
nan_lst = ["ì„ëŒ€ë³´ì¦ê¸ˆ","ì„ëŒ€ë£Œ"]

for column in nan_lst:
    train[column].replace("-", "0", inplace = True)
    train[column].fillna("0", inplace = True)
    train[column] = train[column].astype(int)
    
    test[column].replace("-", "0", inplace = True)
    test[column].fillna("0", inplace = True)
    test[column] = test[column].astype(int)
    
# train ì§€í•˜ì² ìˆ˜, ë²„ìŠ¤ìˆ˜ ê²°ì¸¡ê°’ 0ìœ¼ë¡œ ëŒ€ì²´
train["ì§€í•˜ì² ìˆ˜"].fillna(0, inplace = True)
#train["ë²„ìŠ¤ìˆ˜"].fillna(0, inplace = True)

# test ì§€í•˜ì² ìˆ˜ ê²°ì¸¡ê°’ 0ìœ¼ë¡œ ëŒ€ì²´
test["ì§€í•˜ì² ìˆ˜"].fillna(0, inplace = True)

# test ìê²©ìœ í˜• ê²°ì¸¡ê°’ ëŒ€ì²´: ë°ì´í„° ì‚­ì œí›„ë„ ì¸ë±ìŠ¤ ë²ˆí˜¸ ìˆ˜ì •ì—†ì–´ì„œ ìš°ì„  ì´ë ‡ê²Œ ì‚¬ìš©
test.loc[196, "ìê²©ìœ í˜•"] = "A"
test.loc[258, "ìê²©ìœ í˜•"] = "C"

print("train ê²°ì¸¡ ìˆ˜:", train.isna().sum().sum())
print("test ê²°ì¸¡ ìˆ˜:", test.isna().sum().sum())
```

    train ê²°ì¸¡ ìˆ˜: 0
    test ê²°ì¸¡ ìˆ˜: 0
    

- ê²°ì¸¡ê°’ ëŒ€ì²´ëŠ” ì´ˆê¸°ì™€ ë™ì¼í•˜ê²Œ ì‘ì„±í•˜ì˜€ë‹¤.

### 1.4.1 ê¸°ë³¸ í† ëŒ€ 


```python
# ë‹¨ì§€ì½”ë“œ ë ˆë²¨ì˜ ë°ì´í„° ë¼ˆëŒ€í•¨ìˆ˜
def new_df(df):
    # ë‹¨ì§€ì½”ë“œë³„ ê° ì»¬ëŸ¼ ì¤‘ë³µ ì œì™¸ ìˆ˜
    df_coldup = df.groupby(["ë‹¨ì§€ì½”ë“œ"]).nunique()
    df_coldup_cnt = df_coldup.sum()
    df_coldup_cnt

    # ë‹¨ì§€ì½”ë“œ ë ˆë²¨
    level = df["ë‹¨ì§€ì½”ë“œ"].nunique()

    # ì¤‘ë³µ ì—†ëŠ” ì»¬ëŸ¼
    no_dup_col = df_coldup_cnt[df_coldup_cnt == level].index.values

    # ì¤‘ë³µ ìˆëŠ” ì»¬ëŸ¼
    dup_col = df_coldup_cnt[df_coldup_cnt != level].index.values

    # ë‹¨ì§€ì½”ë“œ ë ˆë²¨ì˜ ë°ì´í„° ë¼ˆëŒ€
    new_df = df.drop_duplicates(no_dup_col).set_index("ë‹¨ì§€ì½”ë“œ")[no_dup_col]
    new_df = new_df.reset_index()
      
    new_df2 = pd.merge(new_df,age_gender_info, on="ì§€ì—­").set_index("ë‹¨ì§€ì½”ë“œ")
    
    new_df3 = pd.get_dummies(new_df2.sort_index())
    
    return new_df3
```

- ì§€ì—­ ì„ëŒ€ì£¼íƒ ë‚˜ì´ë³„, ì„±ë³„ ì¸êµ¬ ë¶„í¬ë¥¼ ì¶”ê°€í•œ ë¼ˆëŒ€ ë°ì´í„° ìƒì„±í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ì˜€ë‹¤.


```python
new_train, new_test = new_df(train), new_df(test)

# targetì€ ë¶„ë¦¬
target = new_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"]
new_train.drop("ë“±ë¡ì°¨ëŸ‰ìˆ˜", inplace=True, axis=1)

# testì—ëŠ” ì—†ëŠ” ì§€ì—­_ì„œìš¸íŠ¹ë³„ì‹œëŠ” ëª¨ë‘ 0ìœ¼ë¡œ ì„¤ì • - ì»¬ëŸ¼ ìˆœì„œ trainê³¼ ê°™ê²Œ
new_test["ì§€ì—­_ì„œìš¸íŠ¹ë³„ì‹œ"]=0
new_test = new_test[new_train.columns.values]
```


```python
new_train.head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <th>ê³µê°€ìˆ˜</th>
      <th>ì§€í•˜ì² ìˆ˜</th>
      <th>ë²„ìŠ¤ìˆ˜</th>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
      <th>10ëŒ€ë¯¸ë§Œ(ì—¬ì)</th>
      <th>10ëŒ€ë¯¸ë§Œ(ë‚¨ì)</th>
      <th>10ëŒ€(ì—¬ì)</th>
      <th>10ëŒ€(ë‚¨ì)</th>
      <th>20ëŒ€(ì—¬ì)</th>
      <th>20ëŒ€(ë‚¨ì)</th>
      <th>30ëŒ€(ì—¬ì)</th>
      <th>30ëŒ€(ë‚¨ì)</th>
      <th>40ëŒ€(ì—¬ì)</th>
      <th>40ëŒ€(ë‚¨ì)</th>
      <th>50ëŒ€(ì—¬ì)</th>
      <th>50ëŒ€(ë‚¨ì)</th>
      <th>60ëŒ€(ì—¬ì)</th>
      <th>60ëŒ€(ë‚¨ì)</th>
      <th>70ëŒ€(ì—¬ì)</th>
      <th>70ëŒ€(ë‚¨ì)</th>
      <th>80ëŒ€(ì—¬ì)</th>
      <th>80ëŒ€(ë‚¨ì)</th>
      <th>90ëŒ€(ì—¬ì)</th>
      <th>90ëŒ€(ë‚¨ì)</th>
      <th>100ëŒ€(ì—¬ì)</th>
      <th>100ëŒ€(ë‚¨ì)</th>
      <th>ì§€ì—­_ê°•ì›ë„</th>
      <th>ì§€ì—­_ê²½ê¸°ë„</th>
      <th>ì§€ì—­_ê²½ìƒë‚¨ë„</th>
      <th>ì§€ì—­_ê²½ìƒë¶ë„</th>
      <th>ì§€ì—­_ê´‘ì£¼ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€êµ¬ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€ì „ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ë¶€ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì„œìš¸íŠ¹ë³„ì‹œ</th>
      <th>ì§€ì—­_ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ</th>
      <th>ì§€ì—­_ìš¸ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì „ë¼ë‚¨ë„</th>
      <th>ì§€ì—­_ì „ë¼ë¶ë„</th>
      <th>ì§€ì—­_ì œì£¼íŠ¹ë³„ìì¹˜ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë‚¨ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë¶ë„</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>566</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>438.0</td>
      <td>0.034678</td>
      <td>0.035339</td>
      <td>0.059808</td>
      <td>0.06157</td>
      <td>0.060824</td>
      <td>0.064937</td>
      <td>0.061069</td>
      <td>0.056625</td>
      <td>0.082318</td>
      <td>0.072648</td>
      <td>0.082747</td>
      <td>0.074276</td>
      <td>0.07539</td>
      <td>0.062427</td>
      <td>0.041814</td>
      <td>0.027566</td>
      <td>0.027762</td>
      <td>0.011212</td>
      <td>0.005386</td>
      <td>0.00131</td>
      <td>0.000257</td>
      <td>0.000037</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
# train, test ëª¨ë‘ ë‹¨ì§€ì½”ë“œ ë ˆë²¨ë¡œ í•¸ë“¤ë§ ì™„ë£Œ
print(new_train.shape)
print(new_test.shape)
```

    (414, 43)
    (147, 43)
    

### 1.4.2 ì„ëŒ€ê±´ë¬¼êµ¬ë¶„


```python
# ì•„íŒŒíŠ¸, ìƒê°€, ì£¼ìƒë³µí•©ìœ¼ë¡œ ë¶„ë¦¬
def rental_class_apply(x):
    if (x["ì•„íŒŒíŠ¸"] > 0) & (x["ìƒê°€"] > 0): return "ì£¼ìƒë³µí•©"
    
    elif x["ì•„íŒŒíŠ¸"] > 0: return "ì•„íŒŒíŠ¸"
    
    else: return "ìƒê°€"

def rental_class(df):
    # ë‹¨ì§€ì½”ë“œ, ì„ëŒ€ê±´ë¬¼êµ¬ë¶„ë³„ count (ê°’ìœ¼ë¡œëŠ” ë‹¨ì§€ì½”ë“œë³„ë¡œ ê°™ì€ ê°’ì„ ê°€ì§€ëŠ” ì´ì„¸ëŒ€ìˆ˜ ì‚¬ìš© í° ì˜ë¯¸ ì—†ìŒ)
    temp = df.pivot_table("ì´ì„¸ëŒ€ìˆ˜", "ë‹¨ì§€ì½”ë“œ", "ì„ëŒ€ê±´ë¬¼êµ¬ë¶„", aggfunc="count").fillna(0)
    
    # ì•„íŒŒíŠ¸, ìƒê°€, ì£¼ìƒë³µí•©ìœ¼ë¡œ ë¶„ë¦¬
    temp["ê±´ë¬¼"] = temp.apply(lambda x: rental_class_apply(x), axis=1)
    
    # ì›-í•« ì¸ì½”ë”©
    rental = pd.get_dummies(temp[["ê±´ë¬¼"]])
    
    return rental
```

- ì„ëŒ€ê±´ë¬¼êµ¬ë¶„ì€ ì´ˆê¸°ë²„ì „ê³¼ ê°™ì´ ì›-í•« ì¸ì½”ë”©ì„ ì„ íƒí•˜ì˜€ë‹¤.

### 1.4.3 ë©´ì , ì„¸ëŒ€ìˆ˜


```python
# ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
temp = train["ì „ìš©ë©´ì "]//5*5
    
# ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
temp[temp<15] = 15
temp[temp>100]= 100

# trainì˜ ì „ìš©ë©´ì  ë ˆë²¨
unique_col = np.sort(temp.unique())

def area4(df):
    # ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
    temp = df.set_index("ë‹¨ì§€ì½”ë“œ")["ì „ìš©ë©´ì "]//5*5
    
    # ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
    temp[temp<15] = 15
    temp[temp>100]= 100
    
    # ë‹¨ì§€ì½”ë“œë³„ ì „ìš©ë©´ì 
    temp2 = temp.reset_index()
    temp2["ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜"] = df["ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜"].values
    
    # ë‹¨ì§€ì½”ë“œ, ì „ìš©ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ í•©
    temp3 = temp2.pivot_table("ì „ìš©ë©´ì ë³„ì„¸ëŒ€ìˆ˜","ë‹¨ì§€ì½”ë“œ","ì „ìš©ë©´ì ",aggfunc="sum").fillna(0)
    
    # ë§Œì•½ unique_colì—ë§Œ ì¡´ì¬í•˜ëŠ” ì»¬ëŸ¼ì´ ìˆìœ¼ë©´ ê°’ 0ìœ¼ë¡œ ì»¬ëŸ¼ ì¶”ê°€
    extra_col = list(set(unique_col) - set(temp3.columns.values))
    temp3[extra_col] = 0
    temp4 = temp3[unique_col]
    
    # ì»¬ëŸ¼ëª… ìˆ˜ì •
    col_name = [f"ë©´ì _{int(i)}" for i in temp4.columns]
    temp4.columns = col_name
    
    return temp4
```


```python
# 1ë²ˆ ì˜¤ë¥˜ ìˆ˜ì •
def area5(df):
    temp = area4(df)
    temp2 = pd.DataFrame()
    
    for col in temp.columns:
        temp2[col] = temp.apply(lambda x: x[col] /np.sum(x), axis=1) * new_df(df)["ì´ì„¸ëŒ€ìˆ˜"]
    
    return temp2
```

- ìµœì¢…ì ìœ¼ë¡  ì´ˆê¸° ê³ ë¯¼í–ˆë˜ ë°©ë²• ì¤‘ ë°©ë²•4ë¥¼ ì„ íƒí•˜ì˜€ê³  1ë²ˆ ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ê¸° ìœ„í•´ ì¡°ê¸ˆ ë” ì†ë³´ì•˜ë‹¤.


- ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ í•©ê³„ì™€ ì´ì„¸ëŒ€ìˆ˜ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì´ì„¸ëŒ€ìˆ˜ x ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ ë¹„ìœ¨ë¡œ ë§Œë“œëŠ” ë°©ì‹ì„ ì±„íƒí•˜ì˜€ë‹¤.


- ì‹¤ì œë¡œ ë‹¹ì‹œì— ì´ ë¶€ë¶„ì„ ìˆ˜ì •í•˜ê³  ì œì¶œ ê²°ê³¼ì—ì„œ ì˜ˆì¸¡ ì„±ëŠ¥ì´ ê°™ì€ ëª¨ë¸ì„ì—ë„ ì¢‹ì•„ì¡Œì—ˆë‹¤.

### 1.4.4 ê³µê¸‰ìœ í˜•


```python
def supply_apply(x):
    if (x == "êµ­ë¯¼ì„ëŒ€") | (x == "ì¥ê¸°ì „ì„¸"):
        return "êµ­ë¯¼ì„ëŒ€_ì¥ê¸°ì „ì„¸"
    elif x.startswith("ê³µê³µ"):
        return "ê³µê³µì„ëŒ€_ë¶„ì–‘"
    else:
        return x
    
def supply(df):
    temp = df[["ë‹¨ì§€ì½”ë“œ"]]
    temp["ê³µê¸‰ìœ í˜•"] = df["ê³µê¸‰ìœ í˜•"].apply(lambda x: supply_apply(x))
    
    temp2 = temp.drop_duplicates().assign(temp_var=1)
    temp3 = temp2.pivot_table("temp_var","ë‹¨ì§€ì½”ë“œ","ê³µê¸‰ìœ í˜•",aggfunc="count").fillna(0)
    
    return temp3
```

- ê³µê¸‰ìœ í˜•ë„ ê¸°ì¡´ì— ì¼ë¶€ë¥¼ ë¬¶ì–´ ì›-í•« ì¸ì½”ë”©ì„ ì„ íƒí•˜ì˜€ë‹¤.

### 1.4.5 ìê²©ìœ í˜•


```python
train.loc[train.ìê²©ìœ í˜•.isin(['J', 'L', 'K', 'N', 'M', 'O']), 'ìê²©ìœ í˜•'] = 'í–‰ë³µì£¼íƒ_ê³µê¸‰ëŒ€ìƒ'
test.loc[test.ìê²©ìœ í˜•.isin(['J', 'L', 'K', 'N', 'M', 'O']), 'ìê²©ìœ í˜•'] = 'í–‰ë³µì£¼íƒ_ê³µê¸‰ëŒ€ìƒ'

train.loc[train.ìê²©ìœ í˜•.isin(['H', 'B', 'E', 'G']), 'ìê²©ìœ í˜•'] = 'êµ­ë¯¼ì„ëŒ€_ì¥ê¸°ì „ì„¸_ê³µê¸‰ëŒ€ìƒ'
test.loc[test.ìê²©ìœ í˜•.isin(['H', 'B', 'E', 'G']), 'ìê²©ìœ í˜•'] = 'êµ­ë¯¼ì„ëŒ€_ì¥ê¸°ì „ì„¸_ê³µê¸‰ëŒ€ìƒ'

train.loc[train.ìê²©ìœ í˜•.isin(['C', 'I', 'F']), 'ìê²©ìœ í˜•'] = 'ì˜êµ¬ì„ëŒ€_ê³µê¸‰ëŒ€ìƒ'
test.loc[test.ìê²©ìœ í˜•.isin(['C', 'I', 'F']), 'ìê²©ìœ í˜•'] = 'ì˜êµ¬ì„ëŒ€_ê³µê¸‰ëŒ€ìƒ'

# trainì˜ ìê²©ìœ í˜• ë ˆë²¨
unique_col2 = train["ìê²©ìœ í˜•"].unique()

def qualification(df):
    temp = df[["ë‹¨ì§€ì½”ë“œ","ìê²©ìœ í˜•"]]
    temp = temp.drop_duplicates()

    temp[unique_col2]=0
    
    # ì›-í•« ì¸ì½”ë”© (ìê²©ìœ í˜•ê°’ê³¼ ì»¬ëŸ¼ê°’ì´ ë™ì¼í•˜ë©´ í•´ë‹¹ ì»¬ëŸ¼ì— 1ì„ ë¶€ì—¬)
    for value in unique_col2:
        col_idx = temp["ìê²©ìœ í˜•"] == value
        temp.loc[col_idx, value] = 1

    temp.drop("ìê²©ìœ í˜•", inplace=True, axis=1)
    temp2 = temp.groupby("ë‹¨ì§€ì½”ë“œ").sum()
    
    # ì»¬ëŸ¼ëª… ìˆ˜ì •
    col_name = [f"ìê²©_{i}" for i in temp2.columns]
    temp2.columns = col_name
    
    return temp2
```

- ìê²© ìœ í˜•ì˜ ê²½ìš° ì‚¬ì‹¤ ì´ˆê¸° ë²„ì „ì„ ë§ì´ ì‚¬ìš©í•˜ì˜€ë‹¤ê°€ ë‹¤ë¥¸ ë¶„ì˜ [ì½”ë“œ ê³µìœ ](https://dacon.io/competitions/official/235745/codeshare/2851?page=1&dtype=recent)ë¥¼ ë³´ê³  ê±°ì˜ ë§ˆì§€ë§‰ì— ìˆ˜ì •í•˜ì˜€ë‹¤.


- ë§ì´ ì¡°ì‚¬í•˜ì‹œê³  ë…¼ë¦¬ë¥¼ ì •í•´ì„œ ì „ì²˜ë¦¬ í•œ ê²ƒì„ ë³´ê³  ëŒ€ë‹¨í•˜ë‹¤ê³  ìƒê°ì´ ë“¤ì—ˆë‹¤.

### 1.4.6 ì„ëŒ€ë³´ì¦ê¸ˆ, ì„ëŒ€ë£Œ


```python
def rental_cost(df):
    temp = df.groupby("ë‹¨ì§€ì½”ë“œ").mean()[["ì„ëŒ€ë³´ì¦ê¸ˆ","ì„ëŒ€ë£Œ"]]
    return temp
```

- ì¶”ê°€ë¡œ ì„ëŒ€ë³´ì¦ê¸ˆê³¼ ì„ëŒ€ë£Œì— ëŒ€í•´ í‰ê· ê°’ì„ ì‚¬ìš©í• ê¹Œ ì‹¶ì–´ ìƒì„±í•´ë‘ì—ˆë‹¤.

### 1.4.7 ìµœì¢… ê²°í•©


```python
# ì „ìš©ë©´ì ì„ 5ì˜ ë°°ìˆ˜ë¡œ
temp = train["ì „ìš©ë©´ì "]//5*5
    
# ì „ìš©ë©´ì  ìƒí•œ 100, í•˜í•œ 15ë¡œ ì„¤ì •
temp[temp<15] = 15
temp[temp>100]= 100

# trainì˜ ì „ìš©ë©´ì , ìê²©ìœ í˜• ë ˆë²¨
unique_col = np.sort(temp.unique())
unique_col2 = train["ìê²©ìœ í˜•"].unique()

# ê° í”¼ì²˜ ì¸ì½”ë”© ê²°ê³¼ í•©ì³ì£¼ê¸°
def final_df(df, new_df):
    rental_df = rental_class(df)
    area_df = area5(df)
    supply_df = supply(df)
    qualification_df = qualification(df)
    rental_cost_df = rental_cost(df)
    
    # ë¼ˆëŒ€ ë°ì´í„°, ëª¨ë“  í•¨ìˆ˜ë“¤ ë‹¤ ë‹¨ì§€ì½”ë“œë¥¼ indexë¡œ ì •ë ¬ë˜ì–´ìˆìœ¼ë¯€ë¡œ pd.concat ì‚¬ìš©
    final_df = pd.concat([new_df, rental_df, area_df, supply_df, qualification_df], axis=1)
    
    return final_df

final_train, final_test = final_df(train, new_train), final_df(test, new_test)
final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"] = target
```

- ì„ëŒ€ ë³´ì¦ê¸ˆê³¼ ì„ëŒ€ë£Œ í‰ê· ë„ ì‚¬ìš©í• ê±°ë©´ `pd.concat()`ì— ì¶”ê°€í•˜ê¸°ë¡œ í•˜ê³  ì œì™¸ í•´ë‘ì—ˆë‹¤.


- ì•„ë¬´ë˜ë„ ê²°ì¸¡ê°’ ëŒ€ì²´ë¥¼ 0ìœ¼ë¡œ í•œ ê²ƒë„ ë§ì•„ ê·¸ëƒ¥ ì‚¬ìš©í•˜ê¸°ê°€ í˜ë“¤ì–´ ë³´ì˜€ë‹¤.


- ì´ ë‹¤ìŒ ê³¼ì •ë“¤ì€ ë‚´ê°€ ìƒê°í•œ ë…¼ë¦¬ì— ë”°ë¼ í”¼ì²˜ë¥¼ ì œê±°í•˜ê¸°ë„ í•˜ê³  ìŠ¤ì¼€ì¼ë§ í•˜ë©´ì„œ ëª¨ë¸ì„ ì œì¶œí•  ë•Œ ë§ˆë‹¤ ìˆ˜ì •í•˜ì˜€ë‹¤.

#### 1.4.7.1 í”¼ì²˜ ì œê±°


```python
# # ì§€ì—­ë³„ ì„±ë³„ë‚˜ì´ë³„ ë¹„ìœ¨ 
# drop_col = ['10ëŒ€ë¯¸ë§Œ(ì—¬ì)', '10ëŒ€ë¯¸ë§Œ(ë‚¨ì)','10ëŒ€(ì—¬ì)', '10ëŒ€(ë‚¨ì)', '20ëŒ€(ì—¬ì)', 
#             '20ëŒ€(ë‚¨ì)', '30ëŒ€(ì—¬ì)', '30ëŒ€(ë‚¨ì)','40ëŒ€(ì—¬ì)', '40ëŒ€(ë‚¨ì)', '50ëŒ€(ì—¬ì)', 
#             '50ëŒ€(ë‚¨ì)', '60ëŒ€(ì—¬ì)', '60ëŒ€(ë‚¨ì)','70ëŒ€(ì—¬ì)', '70ëŒ€(ë‚¨ì)', '80ëŒ€(ì—¬ì)', 
#             '80ëŒ€(ë‚¨ì)', '90ëŒ€(ì—¬ì)', '90ëŒ€(ë‚¨ì)','100ëŒ€(ì—¬ì)', '100ëŒ€(ë‚¨ì)']

# final_train = final_train.drop(columns = drop_col)
# final_test = final_test.drop(columns = drop_col)

# # ì§€ì—­ ì›-í•« ì¸ì½”ë”©
# drop_col2 = ['ì§€ì—­_ê°•ì›ë„', 'ì§€ì—­_ê²½ê¸°ë„', 'ì§€ì—­_ê²½ìƒë‚¨ë„', 'ì§€ì—­_ê²½ìƒë¶ë„', 'ì§€ì—­_ê´‘ì£¼ê´‘ì—­ì‹œ', 
#              'ì§€ì—­_ëŒ€êµ¬ê´‘ì—­ì‹œ', 'ì§€ì—­_ëŒ€ì „ê´‘ì—­ì‹œ', 'ì§€ì—­_ë¶€ì‚°ê´‘ì—­ì‹œ', 'ì§€ì—­_ì„œìš¸íŠ¹ë³„ì‹œ', 'ì§€ì—­_ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ', 
#              'ì§€ì—­_ìš¸ì‚°ê´‘ì—­ì‹œ', 'ì§€ì—­_ì „ë¼ë‚¨ë„', 'ì§€ì—­_ì „ë¼ë¶ë„', 'ì§€ì—­_ì œì£¼íŠ¹ë³„ìì¹˜ë„', 'ì§€ì—­_ì¶©ì²­ë‚¨ë„', 'ì§€ì—­_ì¶©ì²­ë¶ë„']


# final_train = final_train.drop(columns = drop_col2)
# final_test = final_test.drop(columns = drop_col2)

# ì´ ì„¸ëŒ€ìˆ˜
# drop_col3 = ['ì´ì„¸ëŒ€ìˆ˜']

# final_train = final_train.drop(columns = drop_col3)
# final_test = final_test.drop(columns = drop_col3)

# # ë©´ì ë³„ ì„¸ëŒ€ìˆ˜
# drop_col4 = ['ë©´ì _15', 'ë©´ì _20', 'ë©´ì _25','ë©´ì _30', 'ë©´ì _35', 'ë©´ì _40', 'ë©´ì _45', 'ë©´ì _50', 'ë©´ì _55','ë©´ì _60', 'ë©´ì _65', 'ë©´ì _70', 'ë©´ì _75', 'ë©´ì _80', 'ë©´ì _100']

# final_train = final_train.drop(columns = drop_col4)
# final_test = final_test.drop(columns = drop_col4)
```

- ìš°ì„  ì§€ì—­ë³„ ì„±ë³„ ë‚˜ì´ë³„ ë¹„ìœ¨ì´ ë§ ê·¸ëŒ€ë¡œ "ì§€ì—­"ì— ëŒ€í•œ ìˆ˜ì¹˜ì´ë¯€ë¡œ í° ì˜ë¯¸ê°€ ìˆì„ê¹Œ ì‹¶ì—ˆë‹¤.


- ì§€ì—­ ì›-í•« ì¸ì½”ë”©ì€ ëª¨ë¸ì„ ì œì¶œí•˜ë©´ì„œ ê²°ê³¼ê°€ ë”±íˆ ì¢‹ì§€ ì•Šì•„ ê³ ë¯¼í•˜ì˜€ì—ˆë‹¤.


- ì´ ì„¸ëŒ€ìˆ˜ì™€ ë©´ì ë³„ ì„¸ëŒ€ìˆ˜ëŠ” ë‹¤ì¤‘ê³µì„ ì„±ì´ ë¬¸ì œê°€ ë  ê²ƒ ê°™ì•„ ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ì œê±°í•˜ëŠ” ë°©ì‹ì„ ìƒê°í•˜ì˜€ì—ˆë‹¤.

#### 1.4.7.2 íƒ€ê²Ÿ ì¶”ê°€


```python
# # train ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜ êµ¬ê°„ë³„ ë“±ë¡ì°¨ëŸ‰ìˆ˜ ì§‘ê³„ì¹˜
# temp = final_train.copy()
# temp["ì£¼ì°¨ë©´ìˆ˜ê·¸ë£¹"] = pd.cut(temp["ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜"], 9, labels=range(9))
# temp["target"] = target
# temp2 = temp.groupby("ì£¼ì°¨ë©´ìˆ˜ê·¸ë£¹").agg({"ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜":["min","max","count"],"target":["mean","median"]})

# # í•„ìš” ë³€ìˆ˜
# criteria = temp2[('ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜','max')]
# target_mean  = temp2[('target','mean')]
# target_median  = temp2[('target','median')]

# def target_add(x, mean=True):
#     # í‰ê· ê°’, ì¤‘ì•™ê°’ ì¤‘ ê²°ì •
#     if mean == True: return_value = target_mean
#     else: return_value = target_median
    
#     # train ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜ êµ¬ê°„ë³„ ë“±ë¡ì°¨ëŸ‰ìˆ˜ ì§‘ê³„ì¹˜ return
#     if x <= criteria[0]: return return_value[0]
#     elif x <= criteria[1]: return return_value[1]
#     elif x <= criteria[2]: return return_value[2]
#     elif x <= criteria[3]: return return_value[3]
#     elif x <= criteria[4]: return return_value[4]
#     elif x <= criteria[5]: return return_value[5]
#     elif x <= criteria[6]: return return_value[6]
#     elif x <= criteria[7]: return return_value[7]
#     elif x <= criteria[8]: return return_value[8]
```


```python
# # í‰ê· ê°’ ì¶”ê°€
# # final_train["t_mean"] = final_train["ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜"].apply(lambda x: target_add(x))
# # final_test["t_mean"] = final_test["ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜"].apply(lambda x: target_add(x))

# # ì¤‘ì•™ê°’ ì¶”ê°€
# final_train["t_median"] = final_train["ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜"].apply(lambda x: target_add(x, mean=False))
# final_test["t_median"] = final_test["ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜"].apply(lambda x: target_add(x, mean=False))
```


```python
# # train ì§€ì—­ë³„ íƒ€ê²Ÿ í‰ê· ê°’, ì¤‘ì•™ê°’ ì •ë³´
# temp = train.drop_duplicates(["ë‹¨ì§€ì½”ë“œ","ì§€ì—­","ë“±ë¡ì°¨ëŸ‰ìˆ˜"])
# temp2 = temp.groupby("ì§€ì—­").agg(["mean","median"])["ë“±ë¡ì°¨ëŸ‰ìˆ˜"].reset_index()
# temp2.columns = ["ì§€ì—­","ì§€ì—­_mean", "ì§€ì—­_median"]

# # ì›í•˜ëŠ” í˜•íƒœë¡œ ìƒì„±
# temp3 = train.drop_duplicates(["ë‹¨ì§€ì½”ë“œ","ì§€ì—­"])
# temp4 = test.drop_duplicates(["ë‹¨ì§€ì½”ë“œ","ì§€ì—­"])

# train_add = pd.merge(temp3, temp2, on="ì§€ì—­").set_index(["ë‹¨ì§€ì½”ë“œ"]).sort_index()[["ì§€ì—­_mean","ì§€ì—­_median"]]
# test_add = pd.merge(temp4, temp2, on="ì§€ì—­").set_index(["ë‹¨ì§€ì½”ë“œ"]).sort_index()[["ì§€ì—­_mean","ì§€ì—­_median"]]

# # ì§€ì—­ë³„ ì •ë³´ ìµœì¢… ë°ì´í„°ì— ì¶”ê°€
# final_train = pd.concat([final_train, train_add], axis=1)
# final_test = pd.concat([final_test, test_add], axis=1)
```

- ì´ ë¶€ë¶„ì€ ë‚˜ì˜ ë…¼ë¦¬ëŠ” ì•„ë‹ˆë©° ë°ì´ì½˜ ì½”ë“œ ê³µìœ ë¥¼ ë³´ê³  ë§Œë“¤ì–´ ë³´ì•˜ë‹¤.


- trainì—ì„œ ì§€ì—­ë³„ë¡œ target ê°’ì˜ í‰ê· , ì¤‘ì•™ê°’ì„ ìƒì„±í•˜ì—¬ testì— ì§€ì—­ë³„ë¡œ merge í•˜ì˜€ë‹¤.


- ê°œì¸ì ìœ¼ë¡  ì´ ë°©ë²•ì€ ì¢€ ì•„ë‹Œ ê²ƒ ê°™ì•˜ëŠ”ë° ì´ ë°©ì‹ì´ ë‹¹ì‹œ ê·¸ ë¶„ì˜ ì ìˆ˜ê°€ 60ë“± ì •ë„ë¡œ ë†’ì•„ ì‹œë„ í•´ë³´ì•˜ë‹¤.


- ì¶”ê°€ë¡œ targetê³¼ ê°€ì¥ ìƒê´€ê´€ê³„ê°€ ë†’ì€ ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜ êµ¬ê°„ì— ë”°ë¥¸ íƒ€ê²Ÿì˜ í‰ê· ê³¼ ì¤‘ì•™ê°’ì„ í”¼ì²˜ë¡œ ìƒì„± í•´ë³´ì•˜ë‹¤.

#### 1.4.7.3 ìŠ¤ì¼€ì¼ë§ ì¶”ê°€


```python
# from sklearn.preprocessing import StandardScaler, RobustScaler

# # íƒ€ê²Ÿ ì¶”ê°€ ë°©ë²•ì— ë”°ë¼ ìˆ˜ì •
# scale_col = ['ê³µê°€ìˆ˜', 'ì§€í•˜ì² ìˆ˜', 'ë²„ìŠ¤ìˆ˜', 'ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜', 'ë©´ì _15', 'ë©´ì _20', 'ë©´ì _25',
#              'ë©´ì _30', 'ë©´ì _35', 'ë©´ì _40', 'ë©´ì _45', 'ë©´ì _50', 'ë©´ì _55',
#              'ë©´ì _60', 'ë©´ì _65', 'ë©´ì _70', 'ë©´ì _75', 'ë©´ì _80', 'ë©´ì _100']
# scale_col = ['ì´ì„¸ëŒ€ìˆ˜', 'ê³µê°€ìˆ˜', 'ì§€í•˜ì² ìˆ˜', 'ë²„ìŠ¤ìˆ˜', 'ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜', 'ì§€ì—­_mean', 'ì§€ì—­_median']
# for col in scale_col:
#     # ìŠ¤ì¼€ì¼ë§ í•  ì»¬ëŸ¼
#     train_sc_col = final_train[col].copy().values.reshape(-1,1)
#     test_sc_col = final_test[col].copy().values.reshape(-1,1)
    
#     # ìŠ¤ì¼€ì¼ëŸ¬
#     scaler_st = StandardScaler()
#     scaler_ro = RobustScaler()
    
#     # ë²„ìŠ¤ìˆ˜ë§Œ Robust, ë‚˜ë¨¸ì§€ëŠ” Standard (train ê¸°ì¤€ì— ë§ì¶”ê¸° í™•ì¸)
#     if col == "ë²„ìŠ¤ìˆ˜":
#         scaler_ro.fit(train_sc_col)
#         final_train[col] = scaler_ro.transform(train_sc_col)
#         final_test[col] = scaler_ro.transform(test_sc_col)
#     else:
#         scaler_st.fit(train_sc_col)
#         final_train[col] = scaler_st.transform(train_sc_col)
#         final_test[col] = scaler_st.transform(test_sc_col)
```


```python
# # ì¼ê´„ ë¡œê·¸ or ë£¨íŠ¸ ë³€í™˜
# scale_col = ['ì´ì„¸ëŒ€ìˆ˜', 'ê³µê°€ìˆ˜', 'ì§€í•˜ì² ìˆ˜', 'ë²„ìŠ¤ìˆ˜', 'ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜', 'ì§€ì—­_mean', 'ì§€ì—­_median']
# # ['ë©´ì _15', 'ë©´ì _20', 'ë©´ì _25', 'ë©´ì _30', 'ë©´ì _35', 'ë©´ì _40', 'ë©´ì _45', 'ë©´ì _50', 'ë©´ì _55', 'ë©´ì _60', 'ë©´ì _65', 'ë©´ì _70', 'ë©´ì _75', 'ë©´ì _80', 'ë©´ì _100']

# for col in scale_col:
#     final_train[col] = np.log1p(final_train[col])
#     final_test[col] = np.log1p(final_test[col])

# final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"] = np.log1p(final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"])
```

- ìŠ¤ì¼€ì¼ë§ì— ìˆì–´ì„œëŠ” ì¡°ê±´ìˆ˜ë¥¼ í™•ì¸í•˜ê³  ê° ì»¬ëŸ¼ì„ ì‚´í´ë³¸ í›„ `StandardScaler()`ì™€ `RobustScaler()`ë¥¼ ê³ ë¯¼í–ˆë‹¤.


- ì‹œê°í™” í•˜ì˜€ì„ ë•Œ ëª¨ìŠµì„ í™•ì¸í•˜ê³  ë¡œê·¸ë‚˜ ë£¨íŠ¸ ë³€í™˜ë„ ê³ ë ¤í•´ë³´ì•˜ë‹¤.


- ì‹œê°í™” íŒŒì¼ì€ ìµœê·¼ì— `plotly` íŒ¨í‚¤ì§€ë¥¼ ì•Œê²Œ ë˜ì–´ ìˆ˜ì •í•˜ì—¬ ì—…ë¡œë“œ í•˜ë ¤ í•œë‹¤.


```python
final_train.head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <th>ê³µê°€ìˆ˜</th>
      <th>ì§€í•˜ì² ìˆ˜</th>
      <th>ë²„ìŠ¤ìˆ˜</th>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
      <th>10ëŒ€ë¯¸ë§Œ(ì—¬ì)</th>
      <th>10ëŒ€ë¯¸ë§Œ(ë‚¨ì)</th>
      <th>10ëŒ€(ì—¬ì)</th>
      <th>10ëŒ€(ë‚¨ì)</th>
      <th>20ëŒ€(ì—¬ì)</th>
      <th>20ëŒ€(ë‚¨ì)</th>
      <th>30ëŒ€(ì—¬ì)</th>
      <th>30ëŒ€(ë‚¨ì)</th>
      <th>40ëŒ€(ì—¬ì)</th>
      <th>40ëŒ€(ë‚¨ì)</th>
      <th>50ëŒ€(ì—¬ì)</th>
      <th>50ëŒ€(ë‚¨ì)</th>
      <th>60ëŒ€(ì—¬ì)</th>
      <th>60ëŒ€(ë‚¨ì)</th>
      <th>70ëŒ€(ì—¬ì)</th>
      <th>70ëŒ€(ë‚¨ì)</th>
      <th>80ëŒ€(ì—¬ì)</th>
      <th>80ëŒ€(ë‚¨ì)</th>
      <th>90ëŒ€(ì—¬ì)</th>
      <th>90ëŒ€(ë‚¨ì)</th>
      <th>100ëŒ€(ì—¬ì)</th>
      <th>100ëŒ€(ë‚¨ì)</th>
      <th>ì§€ì—­_ê°•ì›ë„</th>
      <th>ì§€ì—­_ê²½ê¸°ë„</th>
      <th>ì§€ì—­_ê²½ìƒë‚¨ë„</th>
      <th>ì§€ì—­_ê²½ìƒë¶ë„</th>
      <th>ì§€ì—­_ê´‘ì£¼ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€êµ¬ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€ì „ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ë¶€ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì„œìš¸íŠ¹ë³„ì‹œ</th>
      <th>ì§€ì—­_ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ</th>
      <th>ì§€ì—­_ìš¸ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì „ë¼ë‚¨ë„</th>
      <th>ì§€ì—­_ì „ë¼ë¶ë„</th>
      <th>ì§€ì—­_ì œì£¼íŠ¹ë³„ìì¹˜ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë‚¨ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë¶ë„</th>
      <th>ê±´ë¬¼_ì•„íŒŒíŠ¸</th>
      <th>ê±´ë¬¼_ì£¼ìƒë³µí•©</th>
      <th>ë©´ì _15</th>
      <th>ë©´ì _20</th>
      <th>ë©´ì _25</th>
      <th>ë©´ì _30</th>
      <th>ë©´ì _35</th>
      <th>ë©´ì _40</th>
      <th>ë©´ì _45</th>
      <th>ë©´ì _50</th>
      <th>ë©´ì _55</th>
      <th>ë©´ì _60</th>
      <th>ë©´ì _65</th>
      <th>ë©´ì _70</th>
      <th>ë©´ì _75</th>
      <th>ë©´ì _80</th>
      <th>ë©´ì _100</th>
      <th>ê³µê³µì„ëŒ€_ë¶„ì–‘</th>
      <th>êµ­ë¯¼ì„ëŒ€_ì¥ê¸°ì „ì„¸</th>
      <th>ì˜êµ¬ì„ëŒ€</th>
      <th>ì„ëŒ€ìƒê°€</th>
      <th>í–‰ë³µì£¼íƒ</th>
      <th>ìê²©_A</th>
      <th>ìê²©_êµ­ë¯¼ì„ëŒ€_ì¥ê¸°ì „ì„¸_ê³µê¸‰ëŒ€ìƒ</th>
      <th>ìê²©_ì˜êµ¬ì„ëŒ€_ê³µê¸‰ëŒ€ìƒ</th>
      <th>ìê²©_D</th>
      <th>ìê²©_í–‰ë³µì£¼íƒ_ê³µê¸‰ëŒ€ìƒ</th>
      <th>ë“±ë¡ì°¨ëŸ‰ìˆ˜</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1000</th>
      <td>566</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>438.0</td>
      <td>0.034678</td>
      <td>0.035339</td>
      <td>0.059808</td>
      <td>0.06157</td>
      <td>0.060824</td>
      <td>0.064937</td>
      <td>0.061069</td>
      <td>0.056625</td>
      <td>0.082318</td>
      <td>0.072648</td>
      <td>0.082747</td>
      <td>0.074276</td>
      <td>0.07539</td>
      <td>0.062427</td>
      <td>0.041814</td>
      <td>0.027566</td>
      <td>0.027762</td>
      <td>0.011212</td>
      <td>0.005386</td>
      <td>0.00131</td>
      <td>0.000257</td>
      <td>0.000037</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>419.0</td>
      <td>0.0</td>
      <td>72.0</td>
      <td>75.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>481.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
final_test.head(1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ì´ì„¸ëŒ€ìˆ˜</th>
      <th>ê³µê°€ìˆ˜</th>
      <th>ì§€í•˜ì² ìˆ˜</th>
      <th>ë²„ìŠ¤ìˆ˜</th>
      <th>ë‹¨ì§€ë‚´ì£¼ì°¨ë©´ìˆ˜</th>
      <th>10ëŒ€ë¯¸ë§Œ(ì—¬ì)</th>
      <th>10ëŒ€ë¯¸ë§Œ(ë‚¨ì)</th>
      <th>10ëŒ€(ì—¬ì)</th>
      <th>10ëŒ€(ë‚¨ì)</th>
      <th>20ëŒ€(ì—¬ì)</th>
      <th>20ëŒ€(ë‚¨ì)</th>
      <th>30ëŒ€(ì—¬ì)</th>
      <th>30ëŒ€(ë‚¨ì)</th>
      <th>40ëŒ€(ì—¬ì)</th>
      <th>40ëŒ€(ë‚¨ì)</th>
      <th>50ëŒ€(ì—¬ì)</th>
      <th>50ëŒ€(ë‚¨ì)</th>
      <th>60ëŒ€(ì—¬ì)</th>
      <th>60ëŒ€(ë‚¨ì)</th>
      <th>70ëŒ€(ì—¬ì)</th>
      <th>70ëŒ€(ë‚¨ì)</th>
      <th>80ëŒ€(ì—¬ì)</th>
      <th>80ëŒ€(ë‚¨ì)</th>
      <th>90ëŒ€(ì—¬ì)</th>
      <th>90ëŒ€(ë‚¨ì)</th>
      <th>100ëŒ€(ì—¬ì)</th>
      <th>100ëŒ€(ë‚¨ì)</th>
      <th>ì§€ì—­_ê°•ì›ë„</th>
      <th>ì§€ì—­_ê²½ê¸°ë„</th>
      <th>ì§€ì—­_ê²½ìƒë‚¨ë„</th>
      <th>ì§€ì—­_ê²½ìƒë¶ë„</th>
      <th>ì§€ì—­_ê´‘ì£¼ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€êµ¬ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ëŒ€ì „ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ë¶€ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì„œìš¸íŠ¹ë³„ì‹œ</th>
      <th>ì§€ì—­_ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ</th>
      <th>ì§€ì—­_ìš¸ì‚°ê´‘ì—­ì‹œ</th>
      <th>ì§€ì—­_ì „ë¼ë‚¨ë„</th>
      <th>ì§€ì—­_ì „ë¼ë¶ë„</th>
      <th>ì§€ì—­_ì œì£¼íŠ¹ë³„ìì¹˜ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë‚¨ë„</th>
      <th>ì§€ì—­_ì¶©ì²­ë¶ë„</th>
      <th>ê±´ë¬¼_ì•„íŒŒíŠ¸</th>
      <th>ê±´ë¬¼_ì£¼ìƒë³µí•©</th>
      <th>ë©´ì _15</th>
      <th>ë©´ì _20</th>
      <th>ë©´ì _25</th>
      <th>ë©´ì _30</th>
      <th>ë©´ì _35</th>
      <th>ë©´ì _40</th>
      <th>ë©´ì _45</th>
      <th>ë©´ì _50</th>
      <th>ë©´ì _55</th>
      <th>ë©´ì _60</th>
      <th>ë©´ì _65</th>
      <th>ë©´ì _70</th>
      <th>ë©´ì _75</th>
      <th>ë©´ì _80</th>
      <th>ë©´ì _100</th>
      <th>ê³µê³µì„ëŒ€_ë¶„ì–‘</th>
      <th>êµ­ë¯¼ì„ëŒ€_ì¥ê¸°ì „ì„¸</th>
      <th>ì˜êµ¬ì„ëŒ€</th>
      <th>ì„ëŒ€ìƒê°€</th>
      <th>í–‰ë³µì£¼íƒ</th>
      <th>ìê²©_A</th>
      <th>ìê²©_êµ­ë¯¼ì„ëŒ€_ì¥ê¸°ì „ì„¸_ê³µê¸‰ëŒ€ìƒ</th>
      <th>ìê²©_ì˜êµ¬ì„ëŒ€_ê³µê¸‰ëŒ€ìƒ</th>
      <th>ìê²©_D</th>
      <th>ìê²©_í–‰ë³µì£¼íƒ_ê³µê¸‰ëŒ€ìƒ</th>
    </tr>
    <tr>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C1003</th>
      <td>480</td>
      <td>29.0</td>
      <td>0.0</td>
      <td>3.0</td>
      <td>339.0</td>
      <td>0.0274</td>
      <td>0.026902</td>
      <td>0.053257</td>
      <td>0.055568</td>
      <td>0.06492</td>
      <td>0.070618</td>
      <td>0.056414</td>
      <td>0.05755</td>
      <td>0.077092</td>
      <td>0.0676</td>
      <td>0.086873</td>
      <td>0.07257</td>
      <td>0.087201</td>
      <td>0.069562</td>
      <td>0.048357</td>
      <td>0.033277</td>
      <td>0.027361</td>
      <td>0.011295</td>
      <td>0.00491</td>
      <td>0.001086</td>
      <td>0.000179</td>
      <td>0.00001</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>128.0</td>
      <td>0.0</td>
      <td>250.0</td>
      <td>0.0</td>
      <td>68.0</td>
      <td>34.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>



## 1.5 ëª¨ë¸

### 1.5.1 êµì°¨ê²€ì¦


```python
from sklearn.model_selection import KFold, StratifiedKFold, cross_val_score
from sklearn.metrics import mean_absolute_error, make_scorer

# kfold ì •ì˜
kfold = KFold(n_splits=5, shuffle = True, random_state=42)
sk = StratifiedKFold(n_splits=5, shuffle = True, random_state=42)

# MAPE ì •ì˜
def mean_absolute_percentage_error(y_test, y_pred):
    y_test, y_pred = np.array(y_test), np.array(y_pred)
    mape = np.mean(np.abs((y_test - y_pred) / y_test)) * 100
    return mape

# êµì°¨ê²€ì¦ MAE, MAPE 
def get_model_cv_prediction(models, X_data, y_target):
    model_name = []
    MAE = []
    MAE_fold = []
    MAPE = []
    
    # ëª¨ë¸ë³„ë¡œ êµì°¨ ê²€ì¦
    for model in models:
        # MAE
        neg_mae_scores = cross_val_score(model, X_data, y_target, scoring="neg_mean_absolute_error", cv = kfold)
        mae_scores  = -1 * neg_mae_scores
        avg_mae = np.mean(mae_scores)
        
        # MAPE
        neg_mape = cross_val_score(model, X_data, y_target, 
                                   scoring=make_scorer(mean_absolute_percentage_error, greater_is_better=False), 
                                   cv = kfold)
        mape_scores = -1 * neg_mape
        avg_mape = np.mean(mape_scores)
        
        # ë°ì´í„° í”„ë ˆì„ ì •ë³´
        model_name.append(model.__class__.__name__)
        MAE.append(avg_mae)
        MAE_fold.append(mae_scores)
        MAPE.append(avg_mape)
        
    # ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë§Œë“¤ì–´ ì£¼ê¸°
    cross_df = pd.DataFrame(np.round(MAE_fold,2), 
                            index=model_name, columns=[f"MAE_{i+1}" for i in range(5)])
    cross_df["AVG_MAE"] = np.round(MAE,2)
    cross_df["AVG_MAPE"] = np.round(MAPE,2)
    cross_df["MAE_Rank"] = cross_df["AVG_MAE"].rank(method='min')
    cross_df["MAPE_Rank"] = cross_df["AVG_MAPE"].rank(method='min')
    cross_df.index.names = ["Model"]
    
    return cross_df.sort_values(by="MAE_Rank")
```

- ëª¨ë¸ì— ëŒ€í•´ í‰ê°€í•˜ê¸° ìœ„í•´ êµì°¨ê²€ì¦ìœ¼ë¡œ MAEì™€ MAPEë¥¼ í™•ì¸í•˜ì˜€ë‹¤.


- ì—¬ëŸ¬ ëª¨ë¸ì„ í•œë²ˆì— ë¹„êµí•˜ê¸° ìœ„í•´ì„œ ë°ì´í„° í”„ë ˆì„ í˜•íƒœë¡œ ì¶œë ¥ë˜ê²Œë” ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.


```python
from sklearn.model_selection import KFold, StratifiedKFold, cross_val_score
from sklearn.metrics import mean_absolute_error, make_scorer

# kfold ì •ì˜
kfold = KFold(n_splits=5, shuffle = True, random_state=42)
sk = StratifiedKFold(n_splits=5, shuffle = True, random_state=42)

# MAPE ì •ì˜
def mean_absolute_percentage_error(y_test, y_pred):
    y_test, y_pred = np.array(y_test), np.array(y_pred)
    mape = np.mean(np.abs((y_test - y_pred) / y_test)) * 100
    return mape

# êµì°¨ê²€ì¦ MAE, MAPE 
def get_model_cv_prediction2(models, X_data, y_target):
    model_name = []
    MAE = []
    MAE_fold2 = []
    MAPE = []
    MAE_fold = []
    MAPE_fold = []
    
    # ëª¨ë¸ë³„ë¡œ êµì°¨ ê²€ì¦
    for model in models:
        MAE_fold = []
        for i, (train_idx, test_idx) in enumerate(kfold.split(X_data)):
            X_train, X_test = X_data.iloc[train_idx], X_data.iloc[test_idx]
            y_train, y_test = y_target.iloc[train_idx], y_target.iloc[test_idx]

            # í•™ìŠµ ë° ì˜ˆì¸¡
            model.fit(X_train,y_train)
            pred = model.predict(X_test)

            # í‰ê°€: MAE, MAPE
            mae = mean_absolute_error(y_test**2, pred**2)
            mape = mean_absolute_percentage_error(y_test**2, pred**2)
            MAE_fold.append(mae)
            MAPE_fold.append(mape)
        
        # ë°ì´í„° í”„ë ˆì„ ì •ë³´
        model_name.append(model.__class__.__name__)
        MAE.append(np.mean(MAE_fold))
        MAE_fold2.append(MAE_fold)
        MAPE.append(np.mean(MAPE_fold))
        
    # ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ ë§Œë“¤ì–´ ì£¼ê¸°
    cross_df = pd.DataFrame(np.round(MAE_fold2,2), 
                            index=model_name, columns=[f"MAE_{i+1}" for i in range(5)])
    cross_df["AVG_MAE"] = np.round(MAE,2)
    cross_df["AVG_MAPE"] = np.round(MAPE,2)
    cross_df["MAE_Rank"] = cross_df["AVG_MAE"].rank(method='min')
    cross_df["MAPE_Rank"] = cross_df["AVG_MAPE"].rank(method='min')
    cross_df.index.names = ["Model"]
    
    return cross_df.sort_values(by="MAE_Rank")
```

- ë˜‘ê°™ì´ êµì°¨ ê²€ì¦ì´ì§€ë§Œ targetì„ ë£¨íŠ¸ ë³€í™˜í•˜ì˜€ì„ ë•Œ ì›ë˜ ìŠ¤ì¼€ì¼ë¡œ ë³€ê²½í•˜ê²Œë” ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.


- ì—¬ê¸°ì„  ì•ì˜ ì½”ë“œì™€ ë‹¬ë¦¬ `cross_val_score()`ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ ì¡°ê¸ˆ ë” ë³µì¡í–ˆë‹¤.


- targetì„ ë¡œê·¸ ë³€í™˜í•˜ì˜€ë‹¤ë©´ `np.expm1()`ìœ¼ë¡œ ìˆ˜ì •í•´ì„œ ì‚¬ìš©í•˜ì˜€ë‹¤.


```python
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestRegressor
from xgboost import XGBRegressor
from lightgbm import LGBMRegressor
from catboost import CatBoostRegressor
from sklearn.linear_model import LinearRegression, Ridge, Lasso, ElasticNet, PoissonRegressor

# RandomForestRegressor, XGBRegressor, LGBMRegressor
rf_reg = RandomForestRegressor(random_state=42)
xgb_reg = XGBRegressor(random_state=42)
lgbm_reg = LGBMRegressor(random_state=42)
cat_reg = CatBoostRegressor(verbose=0, random_state=42)

# LinearRegression, Ridge, Lasso, ElasticNet
lr_reg = LinearRegression()
ridge_reg = Ridge()
lasso_reg = Lasso()
elastic_reg = ElasticNet()
poisson_reg = PoissonRegressor()

# ëª¨ë¸ ê°ì²´ ë¦¬ìŠ¤íŠ¸
models = [rf_reg, xgb_reg, lgbm_reg, lr_reg, ridge_reg, lasso_reg, elastic_reg, poisson_reg, cat_reg]

# ëª¨ë“  ë³€ìˆ˜ ì‚¬ìš©
X_feature = final_train.copy().drop(columns="ë“±ë¡ì°¨ëŸ‰ìˆ˜")
y_target = final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"]
X_test = final_test.copy()

# êµì°¨ ê²€ì¦
get_model_cv_prediction(models, X_feature, y_target)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE_1</th>
      <th>MAE_2</th>
      <th>MAE_3</th>
      <th>MAE_4</th>
      <th>MAE_5</th>
      <th>AVG_MAE</th>
      <th>AVG_MAPE</th>
      <th>MAE_Rank</th>
      <th>MAPE_Rank</th>
    </tr>
    <tr>
      <th>Model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lasso</th>
      <td>110.79</td>
      <td>119.69</td>
      <td>138.14</td>
      <td>98.60</td>
      <td>126.20</td>
      <td>118.68</td>
      <td>36.82</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>ElasticNet</th>
      <td>116.77</td>
      <td>120.20</td>
      <td>139.23</td>
      <td>96.74</td>
      <td>123.92</td>
      <td>119.37</td>
      <td>34.01</td>
      <td>2.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>CatBoostRegressor</th>
      <td>133.39</td>
      <td>122.51</td>
      <td>134.80</td>
      <td>92.23</td>
      <td>114.40</td>
      <td>119.47</td>
      <td>33.94</td>
      <td>3.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>Ridge</th>
      <td>115.01</td>
      <td>123.19</td>
      <td>138.52</td>
      <td>99.87</td>
      <td>130.73</td>
      <td>121.46</td>
      <td>39.77</td>
      <td>4.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>LinearRegression</th>
      <td>115.79</td>
      <td>123.15</td>
      <td>138.89</td>
      <td>99.92</td>
      <td>132.56</td>
      <td>122.06</td>
      <td>40.70</td>
      <td>5.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>RandomForestRegressor</th>
      <td>138.35</td>
      <td>122.53</td>
      <td>148.56</td>
      <td>103.87</td>
      <td>115.06</td>
      <td>125.67</td>
      <td>33.26</td>
      <td>6.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>LGBMRegressor</th>
      <td>126.07</td>
      <td>125.61</td>
      <td>142.63</td>
      <td>110.49</td>
      <td>125.62</td>
      <td>126.09</td>
      <td>35.42</td>
      <td>7.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>XGBRegressor</th>
      <td>151.58</td>
      <td>123.85</td>
      <td>151.94</td>
      <td>111.96</td>
      <td>124.54</td>
      <td>132.77</td>
      <td>33.44</td>
      <td>8.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>PoissonRegressor</th>
      <td>295.93</td>
      <td>328.65</td>
      <td>313.59</td>
      <td>248.94</td>
      <td>291.24</td>
      <td>295.67</td>
      <td>143.09</td>
      <td>9.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div>



- ì—¬ëŸ¬ ëª¨ë¸ë¡œ êµì°¨ê²€ì¦ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚¸ ê²°ê³¼ì´ë©° ì—¬ê¸°ì„  í”¼ì²˜ ìŠ¤ì¼€ì¼ë§ì´ë‚˜ ì œê±°ë¥¼ í•˜ì§€ ì•Šì•˜ë‹¤.


- ì‚¬ì‹¤ ë‚˜ëŠ” MAE, MAPEë¥¼ ëª¨ë‘ ê³ ë ¤í•˜ì—¬ ElasticNetì´ ê°€ì¥ ì¢‹ê²Œ ë‚˜ì™”ì–´ì„œ ì´ì— ëŒ€í•´ íŠœë‹í•˜ì˜€ì—ˆë‹¤.


- ë¬¼ë¡  ê·¸ì™€ëŠ” ë³„ê°œë¡œ íšŒê·€ íŠ¸ë¦¬ ëª¨ë¸ë“¤ë„ ë§ì´ ì†ëŒ€ë³´ì•˜ë‹¤.

### 1.5.2 GridSearchCV


```python
from sklearn.model_selection import GridSearchCV

# kfold ì •ì˜
kfold = KFold(n_splits=5, shuffle = True, random_state=42)

def grid_hyper(model, X_feature, y_target, params):
    # GridSearchCV
    grid_cv = GridSearchCV(model, param_grid = params, scoring="neg_mean_absolute_error", cv=kfold, verbose=1)
    grid_cv.fit(X_feature, y_target)

    print("GridSearchCV ìµœì  í•˜ì´í¼ íŒŒë¼ë¯¸í„°:", grid_cv.best_params_)
    print("GridSearchCV ìµœê³  í‰ê·  MAE:", grid_cv.best_score_.round(4))
```


```python
# ëª¨ë“  ë³€ìˆ˜ ì‚¬ìš©
X_feature = final_train.copy().drop(columns="ë“±ë¡ì°¨ëŸ‰ìˆ˜")
y_target = final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"]
X_test = final_test.copy()

# ëª¨ë¸ ê°ì²´: ElasticNet
elastic_reg = ElasticNet()

params = {"max_iter": [1, 5, 10, 50, 100], 
          "alpha": [0.0001, 0.001, 0.01, 0.1, 1, 10, 100], 
          "l1_ratio": np.arange(0.0, 1.0, 0.1)}

grid_hyper(elastic_reg, X_feature, y_target, params)
```

    Fitting 5 folds for each of 350 candidates, totalling 1750 fits
    

    [Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
    

    GridSearchCV ìµœì  í•˜ì´í¼ íŒŒë¼ë¯¸í„°: {'alpha': 0.1, 'l1_ratio': 0.4, 'max_iter': 10}
    GridSearchCV ìµœê³  í‰ê·  MAE: -116.3636
    

    [Parallel(n_jobs=1)]: Done 1750 out of 1750 | elapsed:   11.7s finished
    

- êµì°¨ê²€ì¦ì—ì„œ ê°€ì¥ ì¢‹ì€ ëª¨ë¸ì— ëŒ€í•´ `GridSearchCV()`ë¥¼ ì‚¬ìš©í•˜ì—¬ í•˜ì´í¼ íŒŒë¼ë¯¸í„° íŠœë‹ì„ ì§„í–‰í•˜ì˜€ë‹¤.


- í˜„ì¬ ì½”ë“œì—ì„œ ìœ„ì˜ êµì°¨ê²€ì¦ì€ Lassoê°€ ê°€ì¥ ì¢‹ì•˜ìœ¼ë‹ˆ ë°”ê¿”ì„œ í™•ì¸í•´ë„ ì¢‹ì„ ë“¯ í•˜ë‹¤.


- ì´ˆê¸°ì—ëŠ” ì—¬ê¸°ê¹Œì§€ í™•ì¸ í›„ ì œì¶œì„ ë§ì´ í•˜ì˜€ë‹¤.

### 1.5.3 ì´ìƒê°’ ë ˆë²„ë¦¬ì§€ í™•ì¸


```python
import statsmodels.api as sm
from statsmodels.graphics import utils


# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
dfX0 = final_train.copy().drop(columns="ë“±ë¡ì°¨ëŸ‰ìˆ˜")
dfX = sm.add_constant(dfX0)
dfy = final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"].values

# íšŒê·€ëª¨í˜• ì í•©
model_sm = sm.OLS(dfy, dfX)
result_sm = model_sm.fit()
pred = result_sm.predict(dfX)        # ì˜ˆì¸¡ê°’

# ì˜í–¥ë ¥ í™•ì¸: ì¿¡ì˜ ê±°ë¦¬
influence_sm = result_sm.get_influence()
cooks_d2, pvals = influence_sm.cooks_distance

n = len(dfy)
k = influence_sm.k_vars              # ëª¨ìˆ˜ì˜ ìˆ˜
fox_cr = 4 / (n - k - 1)             # Fox's Criteria
idx = np.where(cooks_d2 > fox_cr)[0] # ì´ìƒê°’, ë ˆë²„ë¦¬ì§€ ì¸ë±ìŠ¤

ax = plt.subplot()

plt.scatter(dfy, pred)
plt.scatter(dfy[idx], pred[idx], s=300, c="r", alpha=0.5)

utils.annotate_axes(range(len(idx)), idx,
                    list(zip(dfy[idx], pred[idx])), [(-20, 15)] * len(idx), size="small", ax=ax)

plt.xlabel("y")
plt.ylabel("Fitted Values")
plt.title("ì£¼ì°¨ìˆ˜ìš” ì„ í˜•íšŒê·€ì‹œ ì•„ì›ƒë¼ì´ì–´")

plt.show()
```


    
![png](../../assets/images/post_images/2021-08-12-01/output_155_0.png)
    


- ë‚˜ëŠ” ElasticNetì„ ì„ íƒí•˜ì˜€ì—ˆê³  í”¼ì²˜ ì„ íƒì˜ ê¸°ëŠ¥ë„ ì¼ë¶€ ìˆê³  ì¡°ê±´ìˆ˜ì— ëŒ€í•œ ë¬¸ì œëŠ” ì—†ë‹¤ê³  ìƒê°í–ˆë‹¤.


- ê·¸ë˜ì„œ ì»¬ëŸ¼ ëŒ€ì‹  ì¸ë±ìŠ¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë ˆë²„ë¦¬ì§€ì™€ ì´ìƒê°’ì„ í™•ì¸í•˜ì—¬ ì œê±°í•´ë³´ê¸°ë¡œ ìƒê°í–ˆë‹¤.


- ìœ„ ì½”ë“œëŠ” ë‹¨ìˆœì„ í˜•íšŒê·€ì—ì„œ ì¿¡ì˜ ê±°ë¦¬ë¥¼ ì‚¬ìš©í•´ ì•„ì›ƒë¼ì´ì–´ ì¸ë±ìŠ¤ë¥¼ ì¶”ì¶œí•œë‹¤.


- ì—¬ê¸°ì„œ ì¶”ì¶œí•œ ì¸ë±ìŠ¤ë¥¼ ì œê±°í•˜ê³  ê°™ì€ ElasticNetìœ¼ë¡œ ì œì¶œì‹œì— MAEê°€ 1ì •ë„ ë‚®ê²Œ ë‚˜íƒ€ë‚¬ì—ˆë‹¤.

### 1.5.4 ìŠ¤íƒœí‚¹ ì•™ìƒë¸”


```python
# ê°œë³„ ëª¨ë¸ë³„ ë©”íƒ€ ë°ì´í„°
def get_stacking_base_datasets(model, X_train, y_train, X_test, n_folds=5):
    # kfold ì •ì˜
    kfold = KFold(n_splits = n_folds, shuffle = True, random_state = 42)
    
    # ë©”íƒ€ ë°ì´í„° ë°˜í™˜ì„ ìœ„í•œ ê¸°ë³¸ ë°°ì—´
    train_cnt = X_train.shape[0]
    test_cnt = X_test.shape[0]
    train_meta = np.zeros((train_cnt, 1))
    test_meta = np.zeros((test_cnt, n_folds))
    
    # train ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ foldë¥¼ ë‚˜ëˆ  í•™ìŠµ/ì˜ˆì¸¡
    for i , (train_fold_idx, test_fold_index) in enumerate(kfold.split(X_train)):
        # train, test fold ìƒì„±
        x_train_fold = X_train[train_fold_idx] 
        y_train_fold = y_train[train_fold_idx] 
        x_test_fold = X_train[test_fold_index]  
        
        # train_foldë¡œ í•™ìŠµ
        model.fit(x_train_fold , y_train_fold)       
        
        # train ë©”íƒ€ ë°ì´í„° ìƒì„± (x_test_fold ì˜ˆì¸¡)
        train_meta[test_fold_index, :] = model.predict(x_test_fold).reshape(-1,1)
        
        # test ë©”íƒ€ ë°ì´í„° ìƒì„± (x_test ì˜ˆì¸¡) - í‰ê·  ì „
        test_meta[:, i] = model.predict(X_test)
            
    # test ë©”íƒ€ ë°ì´í„° ìƒì„± - í‰ê·  ì§„í–‰
    test_meta_mean = np.mean(test_meta, axis=1).reshape(-1,1)    
    
    # train test ë©”íƒ€ ë°ì´í„° ë°˜í™˜
    return train_meta , test_meta_mean
```

- 1.5.3ê¹Œì§€ì˜ ê³¼ì •ìœ¼ë¡œ ë‚´ ë“±ìˆ˜ëŠ” ì „ì²´ 440ëª… ì¤‘ 120ë“± ì •ë„ë¡œ ë‚˜íƒ€ë‚¬ì—ˆë‹¤.


- ë” ë°œì „ì‹œí‚¬ ìˆ˜ ì—†ì„ê¹Œ ê³ ë¯¼í•˜ë‹¤ê°€ ìŠ¤íƒœí‚¹ ì•™ìƒë¸” ëª¨ë¸ì„ ì‚¬ìš©í–ˆë‹¤.


- [ë¨¸ì‹ ëŸ¬ë‹ ì™„ë²½ê°€ì´ë“œ ìŠ¤íƒœí‚¹ ì•™ìƒë¸”](https://romg2.github.io/mlguide/06_%EB%A8%B8%EC%8B%A0%EB%9F%AC%EB%8B%9D-%EC%99%84%EB%B2%BD%EA%B0%80%EC%9D%B4%EB%93%9C-04.-%EB%B6%84%EB%A5%98-%EC%8A%A4%ED%83%9C%ED%82%B9-%EC%95%99%EC%83%81%EB%B8%94/)ì—ì„œ ì •ë¦¬í•œ ì ì´ ìˆì–´ ì´ë¥¼ í™œìš©í–ˆë‹¤.


```python
from sklearn.model_selection import train_test_split

# ëª¨ë“  ë³€ìˆ˜ ì‚¬ìš©
X_feature = final_train.copy().drop(columns="ë“±ë¡ì°¨ëŸ‰ìˆ˜")
y_target = final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"]
X_test = final_test.copy()

# ë°ì´í„° í”„ë ˆì„, ì‹œë¦¬ì¦ˆ -> Numpy ë°°ì—´
X_train = X_feature.values
X_test = X_test.values
y_train = y_target.values

# ê° ëª¨ë¸ í•™ìŠµ
lr_reg = LinearRegression()
ridge_reg = Ridge()
lasso_reg = Lasso()
elastic_reg = ElasticNet()

# ê° ëª¨ë¸ ë©”íƒ€ ë°ì´í„°
lr_train, lr_test = get_stacking_base_datasets(lr_reg, X_train, y_train, X_test)
ridge_train, ridge_test = get_stacking_base_datasets(ridge_reg, X_train, y_train, X_test)
lasso_train, lasso_test = get_stacking_base_datasets(lasso_reg, X_train, y_train, X_test)
elastic_train, elastic_test = get_stacking_base_datasets(elastic_reg, X_train, y_train, X_test)
```

- ë©”íƒ€ ë°ì´í„°ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ëª¨ë¸ì€ 4ê°œì˜ ì„ í˜•íšŒê·€ëª¨ë¸ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.


- ì†”ì§íˆ ë§í•˜ë©´ ì´ì— ëŒ€í•œ ë…¼ë¦¬ëŠ” ì‚¬ì‹¤ ì—†ìœ¼ë©°... ì‹œë„ì— ì˜ì˜ë¥¼ ë’€ë‹¤.


- ë‹¤ë§Œ ì—¬ê¸°ê¹Œì§€ ê³¼ì •ì—ì„œ íšŒê·€ íŠ¸ë¦¬ë³´ë‹¤ëŠ” ì„ í˜• íšŒê·€ê°€ ì¢‹ë‹¤ê³  íŒë‹¨í•´ì„œ ì´ë ‡ê²Œ ë§Œë“¤ì—ˆë‹¤.


```python
# ìµœì¢… ë©”íƒ€ ë°ì´í„° ê²°í•©
final_X_train_meta = np.concatenate((lr_train, ridge_train, lasso_train, elastic_train), axis=1)
final_X_test_meta = np.concatenate((lr_test, ridge_test, lasso_test, elastic_test), axis=1)

# ìµœì¢… ë©”íƒ€ ëª¨ë¸ í•™ìŠµ/ì˜ˆì¸¡
# meta_model_lasso = Lasso()
# meta_model_lasso.fit(final_X_train_meta, y_train)
# meta_predict = meta_model_lasso.predict(final_X_test_meta)

# í‰ê°€ (test target ì—†ìœ¼ë¯€ë¡œ í‰ê°€ ë¶ˆê°€) - > ëŒ€ì‹  ë‹¤ì‹œ meta_trainê³¼ meta_testë¡œ êµì°¨ê²€ì¦
# mae = mean_absolute_error(my_predict, meta_predict)
# print(f"ìŠ¤íƒœí‚¹ íšŒê·€ ëª¨ë¸ MAE: {mae:.4f}")

# --------------------------------------------------------------------------------------------

# RandomForestRegressor, XGBRegressor, LGBMRegressor
rf_reg = RandomForestRegressor(random_state=42)
xgb_reg = XGBRegressor(random_state=42)
lgbm_reg = LGBMRegressor(random_state=42)

# LinearRegression, Ridge, Lasso, ElasticNet
lr_reg = LinearRegression()
ridge_reg = Ridge()
lasso_reg = Lasso()
elastic_reg = ElasticNet()

# ëª¨ë¸ ê°ì²´ ë¦¬ìŠ¤íŠ¸
models = [rf_reg, xgb_reg, lgbm_reg, lr_reg, ridge_reg, lasso_reg, elastic_reg]

# êµì°¨ ê²€ì¦
get_model_cv_prediction(models, final_X_train_meta, y_train)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE_1</th>
      <th>MAE_2</th>
      <th>MAE_3</th>
      <th>MAE_4</th>
      <th>MAE_5</th>
      <th>AVG_MAE</th>
      <th>AVG_MAPE</th>
      <th>MAE_Rank</th>
      <th>MAPE_Rank</th>
    </tr>
    <tr>
      <th>Model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LinearRegression</th>
      <td>117.80</td>
      <td>117.07</td>
      <td>136.06</td>
      <td>95.71</td>
      <td>127.78</td>
      <td>118.88</td>
      <td>37.32</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Ridge</th>
      <td>117.80</td>
      <td>117.07</td>
      <td>136.06</td>
      <td>95.71</td>
      <td>127.78</td>
      <td>118.88</td>
      <td>37.32</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Lasso</th>
      <td>118.88</td>
      <td>118.49</td>
      <td>135.88</td>
      <td>96.26</td>
      <td>127.74</td>
      <td>119.45</td>
      <td>37.81</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>ElasticNet</th>
      <td>118.88</td>
      <td>118.49</td>
      <td>135.88</td>
      <td>96.25</td>
      <td>127.74</td>
      <td>119.45</td>
      <td>37.81</td>
      <td>3.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>LGBMRegressor</th>
      <td>122.10</td>
      <td>121.84</td>
      <td>131.00</td>
      <td>116.84</td>
      <td>140.12</td>
      <td>126.38</td>
      <td>37.56</td>
      <td>5.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>RandomForestRegressor</th>
      <td>117.73</td>
      <td>121.30</td>
      <td>148.32</td>
      <td>118.46</td>
      <td>163.46</td>
      <td>133.85</td>
      <td>38.37</td>
      <td>6.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>XGBRegressor</th>
      <td>130.20</td>
      <td>119.21</td>
      <td>142.67</td>
      <td>130.34</td>
      <td>157.12</td>
      <td>135.91</td>
      <td>37.67</td>
      <td>7.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>



- ì—¬ê¸°ì„  êµì°¨ê²€ì¦ ê²°ê³¼ê°€ ê³ ë§Œê³ ë§Œí•œë° ë‚´ê°€ ì „ì²˜ë¦¬í•œ ë²„ì „ì—ì„œë„ ê·¸ë¬ë‹¤.


- ë‹¤ë§Œ ê·¸ëƒ¥ ì œì¶œì€ í•´ë³´ì•˜ëŠ”ë° ì˜ˆì¸¡ ì„±ëŠ¥ì€ í¬ê²Œ ì €í•˜ë˜ì—ˆë‹¤.


- ì†”ì§íˆ ê·¼ê±°ê°€ ë¶€ì¡±í•œì±„ ì‹œë„í•œ ê²ƒì´ë‹ˆ ê·¸ëŸ´ ìˆ˜ ë°–ì—..

### 1.5.5 pycaret


```python
reg = setup(final_train, 
            preprocess = False, # Trueë¡œ ì„¤ì •ë˜ë©´, ìì²´ì ì¸ Feature Engineeringì„ ì¶”ê°€ë¡œ ì§„í–‰í•´ Predictê°€ ë¶ˆê°€ëŠ¥í•´ì§„ë‹¤.
            train_size = 0.999,  # ìš°ë¦¬ëŠ” ì „ì²´ ë°ì´í„°ë¥¼ í•™ìŠµí•´ testë¥¼ ì˜ˆì¸¡í•˜ëŠ”ê²Œ ëª©í‘œì´ê¸° ë•Œë¬¸ì—, 0.999ë¡œ ì„¤ì •í•œë‹¤.
            target = 'ë“±ë¡ì°¨ëŸ‰ìˆ˜', # ëª©í‘œ ë³€ìˆ˜ëŠ” ë“±ë¡ ì°¨ëŸ‰ ìˆ˜ ì´ë‹¤.
            silent = True, # ì—”í„°ë¥¼ ëˆ„ë¥´ê¸° ê·€ì°®ë‹¤. ê¶ê¸ˆí•˜ë©´ í’€ì–´ë³´ì„¸ìš”
            use_gpu = False, # GPUê°€ ìˆìœ¼ë©´ ì‚¬ìš©í•˜ì„¸ìš” (Cat BOost ì†ë„ í–¥ìƒ)
            numeric_features=list(final_train.drop(columns = ['ë“±ë¡ì°¨ëŸ‰ìˆ˜']).columns), # ëª¨ë“  ë³€ìˆ˜ê°€ ìˆ«ìë¡œì¨ì˜ ì˜ë¯¸ê°€ ìˆë‹¤.
            session_id = 2021,
            fold_shuffle = True,
            fold = 5
            )
```


<style  type="text/css" >
</style><table id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510d" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Description</th>        <th class="col_heading level0 col1" >Value</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row0" class="row_heading level0 row0" >0</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow0_col0" class="data row0 col0" >session_id</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow0_col1" class="data row0 col1" >2021</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row1" class="row_heading level0 row1" >1</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow1_col0" class="data row1 col0" >Target</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow1_col1" class="data row1 col1" >ë“±ë¡ì°¨ëŸ‰ìˆ˜</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row2" class="row_heading level0 row2" >2</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow2_col0" class="data row2 col0" >Original Data</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow2_col1" class="data row2 col1" >(414, 71)</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row3" class="row_heading level0 row3" >3</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow3_col0" class="data row3 col0" >Missing Values</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow3_col1" class="data row3 col1" >False</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row4" class="row_heading level0 row4" >4</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow4_col0" class="data row4 col0" >Numeric Features</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow4_col1" class="data row4 col1" >70</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row5" class="row_heading level0 row5" >5</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow5_col0" class="data row5 col0" >Categorical Features</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow5_col1" class="data row5 col1" >0</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row6" class="row_heading level0 row6" >6</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow6_col0" class="data row6 col0" >Transformed Train Set</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow6_col1" class="data row6 col1" >(413, 70)</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row7" class="row_heading level0 row7" >7</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow7_col0" class="data row7 col0" >Transformed Test Set</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow7_col1" class="data row7 col1" >(1, 70)</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row8" class="row_heading level0 row8" >8</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow8_col0" class="data row8 col0" >Shuffle Train-Test</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow8_col1" class="data row8 col1" >True</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row9" class="row_heading level0 row9" >9</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow9_col0" class="data row9 col0" >Stratify Train-Test</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow9_col1" class="data row9 col1" >False</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row10" class="row_heading level0 row10" >10</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow10_col0" class="data row10 col0" >Fold Generator</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow10_col1" class="data row10 col1" >KFold</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row11" class="row_heading level0 row11" >11</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow11_col0" class="data row11 col0" >Fold Number</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow11_col1" class="data row11 col1" >5</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row12" class="row_heading level0 row12" >12</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow12_col0" class="data row12 col0" >CPU Jobs</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow12_col1" class="data row12 col1" >-1</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row13" class="row_heading level0 row13" >13</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow13_col0" class="data row13 col0" >Use GPU</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow13_col1" class="data row13 col1" >False</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row14" class="row_heading level0 row14" >14</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow14_col0" class="data row14 col0" >Log Experiment</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow14_col1" class="data row14 col1" >False</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row15" class="row_heading level0 row15" >15</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow15_col0" class="data row15 col0" >Experiment Name</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow15_col1" class="data row15 col1" >reg-default-name</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row16" class="row_heading level0 row16" >16</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow16_col0" class="data row16 col0" >USI</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow16_col1" class="data row16 col1" >5bf7</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row17" class="row_heading level0 row17" >17</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow17_col0" class="data row17 col0" >Transform Target</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow17_col1" class="data row17 col1" >False</td>
            </tr>
            <tr>
                        <th id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510dlevel0_row18" class="row_heading level0 row18" >18</th>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow18_col0" class="data row18 col0" >Transform Target Method</td>
                        <td id="T_a3fe90ad_fab9_11eb_929b_8c8d2873510drow18_col1" class="data row18 col1" >box-cox</td>
            </tr>
    </tbody></table>


- `pycaret` íŒ¨í‚¤ì§€ì— ëŒ€í•´ì„œëŠ” ì‚¬ì‹¤ ëŒ€íšŒ ì „ì— ì•„ì˜ˆ ëª°ëë‹¤.


- ì—­ì‹œ ì½”ë“œ ê³µìœ ë¥¼ í•´ì£¼ì‹  ë¶„ ì¤‘ì— í•œ ë¶„ì´ ì‚¬ìš©í•˜ì—¬ì„œ ì ìš©í•´ë³´ì•˜ë‹¤.


- ê°„ëµí•˜ê²Œ ë§í•˜ë©´ Auto MLì´ë¼ í•˜ì—¬ ì •ë§ ê°„í¸í•˜ê²Œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ ë¹„êµí•  ìˆ˜ ìˆë‹¤.


- ë‹¤ë§Œ ê¸°ì¡´ ëª¨ë¸ë“¤ë„ ì˜ ëª¨ë¥´ëŠ”ì±„ Auto MLì„ ì‚¬ìš©í•˜ê¸´ ê·¸ëŸ¬ë‹ˆ ì‚¬ì´í‚·ëŸ°ë¶€í„° ì˜ ê³µë¶€í•  í•„ìš”ê°€ ìˆì–´ë³´ì¸ë‹¤.


```python
top5 = compare_models(n_select = 5, sort = 'MAE')
```


<style  type="text/css" >
    #T_b6b1e866_fab9_11eb_962b_8c8d2873510d th {
          text-align: left;
    }#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col0,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col4,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col6{
            text-align:  left;
            text-align:  left;
        }#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col1,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col5,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col6,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col2,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col3,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col4{
            text-align:  left;
            text-align:  left;
            background-color:  yellow;
        }#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col7{
            text-align:  left;
            text-align:  left;
            background-color:  lightgrey;
        }#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col7,#T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col7{
            text-align:  left;
            text-align:  left;
            background-color:  yellow;
            background-color:  lightgrey;
        }</style><table id="T_b6b1e866_fab9_11eb_962b_8c8d2873510d" ><thead>    <tr>        <th class="blank level0" ></th>        <th class="col_heading level0 col0" >Model</th>        <th class="col_heading level0 col1" >MAE</th>        <th class="col_heading level0 col2" >MSE</th>        <th class="col_heading level0 col3" >RMSE</th>        <th class="col_heading level0 col4" >R2</th>        <th class="col_heading level0 col5" >RMSLE</th>        <th class="col_heading level0 col6" >MAPE</th>        <th class="col_heading level0 col7" >TT (Sec)</th>    </tr></thead><tbody>
                <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row0" class="row_heading level0 row0" >huber</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col0" class="data row0 col0" >Huber Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col1" class="data row0 col1" >115.3960</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col2" class="data row0 col2" >31378.6321</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col3" class="data row0 col3" >175.2310</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col4" class="data row0 col4" >0.7969</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col5" class="data row0 col5" >0.3781</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col6" class="data row0 col6" >0.3110</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow0_col7" class="data row0 col7" >0.0220</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row1" class="row_heading level0 row1" >br</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col0" class="data row1 col0" >Bayesian Ridge</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col1" class="data row1 col1" >116.4981</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col2" class="data row1 col2" >30173.4206</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col3" class="data row1 col3" >171.5853</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col4" class="data row1 col4" >0.8046</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col5" class="data row1 col5" >0.3979</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col6" class="data row1 col6" >0.3328</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow1_col7" class="data row1 col7" >0.0100</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row2" class="row_heading level0 row2" >en</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col0" class="data row2 col0" >Elastic Net</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col1" class="data row2 col1" >117.3078</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col2" class="data row2 col2" >31061.4598</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col3" class="data row2 col3" >173.7949</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col4" class="data row2 col4" >0.7989</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col5" class="data row2 col5" >0.4234</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col6" class="data row2 col6" >0.3383</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow2_col7" class="data row2 col7" >0.0140</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row3" class="row_heading level0 row3" >lasso</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col0" class="data row3 col0" >Lasso Regression</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col1" class="data row3 col1" >117.7470</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col2" class="data row3 col2" >30701.2867</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col3" class="data row3 col3" >172.8898</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col4" class="data row3 col4" >0.8013</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col5" class="data row3 col5" >0.4755</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col6" class="data row3 col6" >0.3800</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow3_col7" class="data row3 col7" >0.6820</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row4" class="row_heading level0 row4" >llar</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col0" class="data row4 col0" >Lasso Least Angle Regression</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col1" class="data row4 col1" >118.8681</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col2" class="data row4 col2" >30887.8080</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col3" class="data row4 col3" >173.7532</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col4" class="data row4 col4" >0.8004</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col5" class="data row4 col5" >0.4098</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col6" class="data row4 col6" >0.3758</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow4_col7" class="data row4 col7" >0.0140</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row5" class="row_heading level0 row5" >ridge</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col0" class="data row5 col0" >Ridge Regression</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col1" class="data row5 col1" >120.5049</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col2" class="data row5 col2" >30749.5082</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col3" class="data row5 col3" >173.4145</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col4" class="data row5 col4" >0.8006</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col5" class="data row5 col5" >0.5401</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col6" class="data row5 col6" >0.4193</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow5_col7" class="data row5 col7" >0.0080</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row6" class="row_heading level0 row6" >lr</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col0" class="data row6 col0" >Linear Regression</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col1" class="data row6 col1" >120.5606</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col2" class="data row6 col2" >31239.3352</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col3" class="data row6 col3" >174.8740</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col4" class="data row6 col4" >0.7974</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col5" class="data row6 col5" >0.5411</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col6" class="data row6 col6" >0.4268</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow6_col7" class="data row6 col7" >0.9920</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row7" class="row_heading level0 row7" >catboost</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col0" class="data row7 col0" >CatBoost Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col1" class="data row7 col1" >121.1781</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col2" class="data row7 col2" >35326.1652</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col3" class="data row7 col3" >186.5193</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col4" class="data row7 col4" >0.7688</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col5" class="data row7 col5" >0.4044</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col6" class="data row7 col6" >0.3544</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow7_col7" class="data row7 col7" >2.4480</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row8" class="row_heading level0 row8" >omp</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col0" class="data row8 col0" >Orthogonal Matching Pursuit</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col1" class="data row8 col1" >122.1022</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col2" class="data row8 col2" >32168.3531</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col3" class="data row8 col3" >177.1473</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col4" class="data row8 col4" >0.7919</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col5" class="data row8 col5" >0.5238</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col6" class="data row8 col6" >0.3636</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow8_col7" class="data row8 col7" >0.0080</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row9" class="row_heading level0 row9" >gbr</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col0" class="data row9 col0" >Gradient Boosting Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col1" class="data row9 col1" >123.7817</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col2" class="data row9 col2" >33592.8381</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col3" class="data row9 col3" >182.3226</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col4" class="data row9 col4" >0.7792</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col5" class="data row9 col5" >0.4072</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col6" class="data row9 col6" >0.3619</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow9_col7" class="data row9 col7" >0.0700</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row10" class="row_heading level0 row10" >et</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col0" class="data row10 col0" >Extra Trees Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col1" class="data row10 col1" >124.4949</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col2" class="data row10 col2" >37413.2829</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col3" class="data row10 col3" >190.7414</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col4" class="data row10 col4" >0.7586</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col5" class="data row10 col5" >0.3851</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col6" class="data row10 col6" >0.3396</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow10_col7" class="data row10 col7" >0.1400</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row11" class="row_heading level0 row11" >rf</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col0" class="data row11 col0" >Random Forest Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col1" class="data row11 col1" >125.5178</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col2" class="data row11 col2" >37187.5891</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col3" class="data row11 col3" >190.4156</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col4" class="data row11 col4" >0.7590</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col5" class="data row11 col5" >0.3854</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col6" class="data row11 col6" >0.3420</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow11_col7" class="data row11 col7" >0.1800</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row12" class="row_heading level0 row12" >lightgbm</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col0" class="data row12 col0" >Light Gradient Boosting Machine</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col1" class="data row12 col1" >127.0279</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col2" class="data row12 col2" >37692.5337</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col3" class="data row12 col3" >192.5957</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col4" class="data row12 col4" >0.7546</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col5" class="data row12 col5" >0.4372</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col6" class="data row12 col6" >0.3575</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow12_col7" class="data row12 col7" >0.2460</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row13" class="row_heading level0 row13" >knn</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col0" class="data row13 col0" >K Neighbors Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col1" class="data row13 col1" >133.2631</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col2" class="data row13 col2" >40213.9164</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col3" class="data row13 col3" >198.9116</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col4" class="data row13 col4" >0.7382</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col5" class="data row13 col5" >0.3894</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col6" class="data row13 col6" >0.3443</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow13_col7" class="data row13 col7" >0.0120</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row14" class="row_heading level0 row14" >xgboost</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col0" class="data row14 col0" >Extreme Gradient Boosting</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col1" class="data row14 col1" >136.7420</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col2" class="data row14 col2" >46205.8734</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col3" class="data row14 col3" >212.7333</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col4" class="data row14 col4" >0.6991</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col5" class="data row14 col5" >0.4138</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col6" class="data row14 col6" >0.3556</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow14_col7" class="data row14 col7" >0.3580</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row15" class="row_heading level0 row15" >ada</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col0" class="data row15 col0" >AdaBoost Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col1" class="data row15 col1" >155.1766</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col2" class="data row15 col2" >44703.4480</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col3" class="data row15 col3" >210.1254</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col4" class="data row15 col4" >0.7081</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col5" class="data row15 col5" >0.5618</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col6" class="data row15 col6" >0.6674</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow15_col7" class="data row15 col7" >0.0500</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row16" class="row_heading level0 row16" >dt</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col0" class="data row16 col0" >Decision Tree Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col1" class="data row16 col1" >176.1759</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col2" class="data row16 col2" >67587.8629</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col3" class="data row16 col3" >259.3459</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col4" class="data row16 col4" >0.5549</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col5" class="data row16 col5" >0.5130</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col6" class="data row16 col6" >0.4761</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow16_col7" class="data row16 col7" >0.0100</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row17" class="row_heading level0 row17" >par</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col0" class="data row17 col0" >Passive Aggressive Regressor</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col1" class="data row17 col1" >186.9468</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col2" class="data row17 col2" >69784.6720</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col3" class="data row17 col3" >255.4789</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col4" class="data row17 col4" >0.5273</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col5" class="data row17 col5" >0.5263</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col6" class="data row17 col6" >0.4916</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow17_col7" class="data row17 col7" >0.0100</td>
            </tr>
            <tr>
                        <th id="T_b6b1e866_fab9_11eb_962b_8c8d2873510dlevel0_row18" class="row_heading level0 row18" >lar</th>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col0" class="data row18 col0" >Least Angle Regression</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col1" class="data row18 col1" >41733994319809752.0000</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col2" class="data row18 col2" >10870071704817007126722848330088448.0000</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col3" class="data row18 col3" >64900271034425656.0000</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col4" class="data row18 col4" >-68423109404778113836527910912.0000</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col5" class="data row18 col5" >25.5408</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col6" class="data row18 col6" >133791045871432.5312</td>
                        <td id="T_b6b1e866_fab9_11eb_962b_8c8d2873510drow18_col7" class="data row18 col7" >0.0160</td>
            </tr>
    </tbody></table>


- ìœ„ì™€ ê°™ì´ ì—¬ëŸ¬ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ ì½”ë“œ í•œ ì¤„ë¡œ ê°„ë‹¨í•˜ê²Œ ë¹„êµí•œë‹¤.


- ì—¬ê¸°ì„œ ë‚˜ì˜¤ëŠ” HuberRegressorì— ëŒ€í•´ ì‚¬ì‹¤ ì˜ ëª°ë¼ì„œ ì‚¬ìš©í•˜ì§€ëŠ” ì•Šì•˜ë‹¤.


- ì²˜ìŒì— ì´ê±° ë³´ê³  ë‚´ê°€ ê³ ë¯¼í•˜ë©´ì„œ êµì°¨ê²€ì¦ ì½”ë“œ ì§œë‘ì—ˆëŠ”ë° ì´ë ‡ê²Œ ê°„ë‹¨íˆ ë‚˜ì˜¤ë‹¤ë‹ˆ.. í•˜ê³  í•œìˆ¨ ì‰¬ì—ˆë‹¤.

### 1.5.6 Catboost


```python
X = final_train.drop(columns = ['ë“±ë¡ì°¨ëŸ‰ìˆ˜'])
y = final_train['ë“±ë¡ì°¨ëŸ‰ìˆ˜']
X_test = final_test.copy()
```


```python
def objective(trial: Trial) -> float:
    params_cat = {
        "random_state": 42,
        "learning_rate": 0.05,
        "n_estimators": 10000,
        "verbose" : 1,
        "objective" : "MAE",
        "max_depth": trial.suggest_int("max_depth", 1, 16),
        "colsample_bylevel": trial.suggest_float("colsample_bylevel", 0.8, 1.0),
        "subsample": trial.suggest_float("subsample", 0.3, 1.0),
        "min_child_samples": trial.suggest_int("min_child_samples", 5, 100),
        "max_bin": trial.suggest_int("max_bin", 200, 500),
    }
    
    X_tr, X_val, y_tr, y_val = train_test_split(X, y, test_size=0.2)

    model = CatBoostRegressor(**params_cat)
    model.fit(
        X_tr,
        y_tr,
        eval_set=[(X_tr, y_tr), (X_val, y_val)],
        early_stopping_rounds=10,
        verbose=False,
    )

    cat_pred = model.predict(X_val)
    log_score = mean_absolute_error(y_val, cat_pred)
    
    return log_score
```


```python
sampler = TPESampler(seed=42)
study = optuna.create_study(
    study_name="cat_opt",
    direction="minimize",
    sampler=sampler,
)
study.optimize(objective, n_trials=10)
print("Best Score:", study.best_value)
print("Best trial:", study.best_trial.params)
```

    [32m[I 2021-08-12 00:35:10,705][0m A new study created in memory with name: cat_opt[0m
    [32m[I 2021-08-12 00:35:12,268][0m Trial 0 finished with value: 92.24671653337226 and parameters: {'max_depth': 6, 'colsample_bylevel': 0.9901428612819833, 'subsample': 0.8123957592679836, 'min_child_samples': 62, 'max_bin': 246}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:35:12,784][0m Trial 1 finished with value: 109.8821593598015 and parameters: {'max_depth': 3, 'colsample_bylevel': 0.8116167224336399, 'subsample': 0.9063233020424546, 'min_child_samples': 62, 'max_bin': 413}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:35:13,171][0m Trial 2 finished with value: 109.31221155027754 and parameters: {'max_depth': 1, 'colsample_bylevel': 0.9939819704323989, 'subsample': 0.8827098485602951, 'min_child_samples': 25, 'max_bin': 254}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:35:13,668][0m Trial 3 finished with value: 154.1296660512618 and parameters: {'max_depth': 3, 'colsample_bylevel': 0.8608484485919076, 'subsample': 0.6673295021425665, 'min_child_samples': 46, 'max_bin': 287}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:35:19,105][0m Trial 4 finished with value: 138.27730011645548 and parameters: {'max_depth': 10, 'colsample_bylevel': 0.8278987721304084, 'subsample': 0.5045012539746527, 'min_child_samples': 40, 'max_bin': 337}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:35:37,577][0m Trial 5 finished with value: 136.28187102921873 and parameters: {'max_depth': 13, 'colsample_bylevel': 0.8399347564316719, 'subsample': 0.6599641068895281, 'min_child_samples': 61, 'max_bin': 213}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:35:40,517][0m Trial 6 finished with value: 133.20249858683397 and parameters: {'max_depth': 10, 'colsample_bylevel': 0.8341048247374584, 'subsample': 0.3455361150896956, 'min_child_samples': 96, 'max_bin': 490}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:36:06,769][0m Trial 7 finished with value: 130.952199266353 and parameters: {'max_depth': 13, 'colsample_bylevel': 0.8609227538346742, 'subsample': 0.3683704798044687, 'min_child_samples': 70, 'max_bin': 332}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:36:06,997][0m Trial 8 finished with value: 100.76298206168725 and parameters: {'max_depth': 2, 'colsample_bylevel': 0.8990353820222541, 'subsample': 0.32407196478065287, 'min_child_samples': 92, 'max_bin': 277}. Best is trial 0 with value: 92.24671653337226.[0m
    [32m[I 2021-08-12 00:36:16,830][0m Trial 9 finished with value: 160.94694165204828 and parameters: {'max_depth': 11, 'colsample_bylevel': 0.8623422152178822, 'subsample': 0.6640476148244676, 'min_child_samples': 57, 'max_bin': 255}. Best is trial 0 with value: 92.24671653337226.[0m
    

    Best Score: 92.24671653337226
    Best trial: {'max_depth': 6, 'colsample_bylevel': 0.9901428612819833, 'subsample': 0.8123957592679836, 'min_child_samples': 62, 'max_bin': 246}
    

- ìœ„ ì½”ë“œ ì—­ì‹œ ì½”ë“œ ê³µìœ ë¥¼ ê·¸ëŒ€ë¡œ ê¸ì–´ì˜¨ ê²ƒìœ¼ë¡œ ë‚´ê°€ ë§Œë“  ê±´ ì•„ë‹ˆë‹¤.


- `optuna` íŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•´ì„œ trainì„ ë‚˜ëˆ  validationì— ëŒ€í•œ ì„±ëŠ¥ì„ ê¸°ì¤€ìœ¼ë¡œ Catboost ëª¨ë¸ì„ íŠœë‹í•˜ì˜€ë‹¤.


- ì—¬ê¸°ì„œ ì„¤ì •í•œ íŒŒë¼ë¯¸í„°ì— ë”°ë¼ ì»¬ëŸ¼ê³¼ ì¸ë±ìŠ¤ì˜ ë¹„ìœ¨ì´ ì •í•´ì§€ë¯€ë¡œ êµ³ì´ í”¼ì²˜ ì„ íƒì„ ì•ˆí•´ë„ ë˜ê² ë‹¤ ì‹¶ì—ˆë‹¤.


```python
# ì•ì„œ í™•ì¸í•œ íŒŒë¼ë¯¸í„° ì ìš©
cat_p = study.best_trial.params
cat = CatBoostRegressor(**cat_p)
```


```python
# ëª¨ë“  ë³€ìˆ˜ ì‚¬ìš©
X_feature = final_train.copy().drop(columns="ë“±ë¡ì°¨ëŸ‰ìˆ˜")
y_target = final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"]
X_test = final_test.copy()

cat.fit(X_feature, y_target, verbose=0)
```




    <catboost.core.CatBoostRegressor at 0x21cfa6b8760>




```python
# mae
mean_absolute_error(y_target, cat.predict(X_feature))
```




    26.54546914274491




```python
mean_absolute_percentage_error(y_target, cat.predict(X_feature))
```




    9.188104655250816



- ì—¬ê¸°ì„œ trainì— ëŒ€í•œ ì˜ˆì¸¡ í›„ MAEë¥¼ í™•ì¸í•˜ë©´ 26, MAPEëŠ” 9% ì •ë„ë¡œ ë‚˜íƒ€ë‚œë‹¤.


- ì•ì„œ êµì°¨ê²€ì¦ì—ì„œ ë³´í†µ 110ëŒ€ë¡œ ë‚˜íƒ€ë‚¬ëŠ”ë° ì•„ë¬´ë¦¬ train ì˜ˆì¸¡ì´ë¼ì§€ë§Œ ë„ˆë¬´ ë‚®ê²Œ ë‚˜íƒ€ë‚¬ë‹¤.


- ë¬¼ë¡  ìœ„ ì½”ë“œì—ì„œ objective í•¨ìˆ˜ë¥¼ ì •ì˜í•  ë•Œ `train_test_split()` í•¨ìˆ˜ì— ì‹œë“œë¥¼ ì„¤ì •í•˜ì§€ ì•Šì•„ ê²°ê³¼ëŠ” ë‹¬ë¼ì§„ë‹¤.


- ì•„ë¬´íŠ¼ êµì°¨ê²€ì¦ì—ì„œ catboost ì—­ì‹œ MAEê°€ 100ì´ í›Œì© ë„˜ì—ˆëŠ”ë° ì´í•´ê°€ ì•ˆë˜ì„œ í™•ì¸í•´ë³´ì•˜ë‹¤.


- í™•ì¸í•´ë³´ë‹ˆ íŠ¸ë¦¬ ê³„ì—´ ëª¨ë¸ë“¤ì€ íšŒê·€ ëª¨ë¸ì— ë¹„í•´ ì•„ë¬´ íŠœë‹ì—†ì´ ê·¸ëƒ¥ í•™ìŠµë§Œ ì‹œì¼œë„ trainì— ë„ˆë¬´ ê³¼ì í•©ë˜ì–´ ë‚˜íƒ€ë‚¬ë‹¤.


- ê·¸ë˜ì„œ ìœ„ ì½”ë“œë„ ì‚¬ì‹¤ `train_test_split()`ì„ ì´ìš©í•´ì„œ ê³¼ì í•©ì„ í”¼í•˜ê¸° ìœ„í•œ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ëŠ” ë°©ë²•ì´ë‹¤.

## 1.6 ì œì¶œ


```python
# ëª¨ë“  ë³€ìˆ˜ ì‚¬ìš©
X_feature = final_train.copy().drop(columns="ë“±ë¡ì°¨ëŸ‰ìˆ˜")
y_target = final_train["ë“±ë¡ì°¨ëŸ‰ìˆ˜"]
X_test = final_test.copy()

# ëª¨ë¸ ê°ì²´ ìƒì„±
# ìµœì  í•˜ì´í¼ íŒŒë¼ë¯¸í„°: {'alpha': 0.1, 'l1_ratio': 0.1, 'max_iter': 100}
elastic_reg = ElasticNet(alpha=0.1, l1_ratio=0.1, max_iter=100)

# í•™ìŠµ
elastic_reg.fit(X_feature, y_target)

# ì˜ˆì¸¡
my_predict = elastic_reg.predict(X_test)

# êµì°¨ ê²€ì¦
get_model_cv_prediction([elastic_reg], X_feature, y_target)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE_1</th>
      <th>MAE_2</th>
      <th>MAE_3</th>
      <th>MAE_4</th>
      <th>MAE_5</th>
      <th>AVG_MAE</th>
      <th>AVG_MAPE</th>
      <th>MAE_Rank</th>
      <th>MAPE_Rank</th>
    </tr>
    <tr>
      <th>Model</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ElasticNet</th>
      <td>114.94</td>
      <td>118.75</td>
      <td>138.3</td>
      <td>95.74</td>
      <td>121.79</td>
      <td>117.9</td>
      <td>34.35</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# ì˜ˆì¸¡ ë°ì´í„° í”„ë ˆì„
predict_df = final_test.reset_index()[["ë‹¨ì§€ì½”ë“œ"]]
predict_df["predict"] = my_predict
predict_df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ë‹¨ì§€ì½”ë“œ</th>
      <th>predict</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C1003</td>
      <td>215.515024</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1006</td>
      <td>239.713304</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C1016</td>
      <td>704.580005</td>
    </tr>
    <tr>
      <th>3</th>
      <td>C1019</td>
      <td>272.046292</td>
    </tr>
    <tr>
      <th>4</th>
      <td>C1030</td>
      <td>37.036826</td>
    </tr>
  </tbody>
</table>
</div>




```python
# ì œì¶œ íŒŒì¼ ë‚´ë³´ë‚´ê¸°
temp = pd.merge(submission, predict_df, left_on="code", right_on="ë‹¨ì§€ì½”ë“œ", how="left")
temp["num"] = temp["predict"]
my_submission = temp[["code","num"]].fillna(0)

# ì €ì¥í•  ë•Œë§Œ ì‚¬ìš©
# my_submission.to_csv('ì œì¶œíŒŒì¼/predict_28.csv', index=False)
```

- ì œì¶œ ì½”ë“œëŠ” íŠ¹ë³„í•œ ê²ƒì€ ì—†ê³  train, testë¥¼ ë‹¨ì§€ì½”ë“œ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ì˜€ê¸°ì— `pd.merge()`ë¥¼ ì‚¬ìš©í•˜ì˜€ë‹¤.

## 1.7 EOD

ì—¬ê¸°ê¹Œì§€ ë‚´ê°€ í•œ ë‹¬ê°„ ì‘ì—…í–ˆë˜ ë‚´ìš©ì— ëŒ€í•´ ì •ë¦¬í•´ë³´ì•˜ë‹¤. ìœ„ ë‚´ìš© ì™¸ì—ë„ targetê³¼ ìƒê´€ê´€ê³„ê°€ ë†’ì€ í”¼ì²˜ì˜ ë¶„í¬ë¥¼ í™•ì¸í•˜ê³  ì„œë¸Œì…‹ì„ ë‚˜ëˆ  ê°ê° ë‹¤ë¥¸ ëª¨ë¸ì„ ì ìš©ë„ í•´ë³´ì•˜ê³  ë” ë§ì€ ì‹œë„ë¥¼ í•´ë³´ì•˜ë˜ ê²ƒ ê°™ë‹¤. ë‹¤ë¥¸ ë¶„ì´ trainì˜ target ì •ë³´ë¥¼ testì— ì‹¬ì–´ì¤€ ê²ƒì„ ë³´ê³  ì–´ë– í•œ ë…¼ë¦¬ë¡œ ì‚¬ìš©í•˜ì…¨ëŠ”ì§€ ê³ ë¯¼í•´ë³´ê³  ê·¸ ë¶„ì´ ë‹¹ì‹œ 60ë“± ì •ë„ì—¬ì„œ ë‚´ê°€ ê·¸ë™ì•ˆ ë„ˆë¬´ í¸ê²¬ì´ ìˆì—ˆë‚˜ ì‹¶ê¸°ë„ í–ˆì—ˆë‹¤.

ê·¸ë¦¬ê³  ë‚˜ì˜ ê²°ê³¼ì— ëŒ€í•´ì„œ ë§í•˜ìë©´ 511íŒ€ ì¤‘ publicì—ì„  80ë“±, privateì—ì„  151ë“±ìœ¼ë¡œ ë§ˆë¬´ë¦¬í–ˆë‹¤. ì—¬ê¸°ì„  ìì„¸íˆ ë‹¤ë£¨ì§€ ì•Šì•˜ì§€ë§Œ trainê³¼ testì˜ ë¶„í¬ê°€ ë§ì´ ë‹¬ëê³  ì• ì´ˆì— ì œì¶œì‹œì—ëŠ” test 150ê°œ ë‹¨ì§€ ì¤‘ 50 ë‹¨ì§€ì— ëŒ€í•œ MAEë§Œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‹ˆ ë”ë”ìš± ê³¼ì í•©ì— ìœ ì˜í•˜ì—¬ì•¼ í•œë‹¤. ë‹¹ì—°íˆ ì´ ìƒê°ë„ í•˜ì˜€ê³  ìµœëŒ€í•œ trainê³¼ testë¥¼ ë¹„ìŠ·í•œ êµ¬ì¡°ë¡œ ì „ì²˜ë¦¬í•˜ê³  trainì— ëŒ€í•œ êµì°¨ê²€ì¦ ì„±ëŠ¥ì„ ë†’ì´ëŠ” ë°©í–¥ìœ¼ë¡œ ê²°ì •í•˜ì˜€ëŠ”ë° ì•„ë¬´ë˜ë„ public ë“±ìˆ˜ì— ì§‘ì°©í•˜ê²Œ ë˜ì—ˆë‹¤. êµì°¨ê²€ì¦ ê²°ê³¼ëŠ” ë” ì•ˆì¢‹ì€ ëª¨ë¸ì¸ë° public ë“±ìˆ˜ëŠ” ë” ë†’ì•„ì§€ê¸°ë„ í•˜ë©´ì„œ í˜¼ë€ì´ ë§ì´ ì™”ë‹¤. ë‚˜ë¦„ ì „ì²˜ë¦¬ë¥¼ ìµœëŒ€í•œ ë§ì·„ë‹¤ê³  ìƒê°í–ˆëŠ”ë° ì´ëŸ° ê²°ê³¼ê°€ ë‚˜íƒ€ë‚˜ë‹ˆ ì–´ë–»ê²Œ ì†ë´ì•¼í• ê¹Œ ì‹¶ê¸°ë„ í–ˆë‹¤. ì²˜ìŒë¶€í„° ì—ìë‹ˆ ë§ˆê°ì‹œê°„ì´ ì–¼ë§ˆ ë‚¨ì§€ë„ ì•Šì•„ ê²°êµ­ public ì ìˆ˜ê°€ ì œì¼ ì¢‹ì€ ëª¨ë¸ë¡œ ìµœì¢… ì œì¶œí•˜ì˜€ëŠ”ë° ë“±ìˆ˜ê°€ í™• ë–¨ì–´ì¡Œë‹¤. 

ì´ë²ˆ ëŒ€íšŒëŠ” ë‹¨ì§€ì½”ë“œ ë ˆë²¨ë¡œ ì „ì²˜ë¦¬ì‹œ trainê³¼ testì˜ ë°ì´í„°ê°€ ë„ˆë¬´ ì ê¸°ë„ í•˜ì˜€ê³  ì‹¤ì œ publicì˜ ìƒìœ„ê¶Œ ë¶„ë“¤ì€ privateì—ì„œ ë“±ìˆ˜ê°€ ë§ì´ ë–¨ì–´ì ¸ ë‹¤ë¥¸ ëŒ€íšŒì— ë¹„í•´ì„œ ë“±ìˆ˜ë³€ë™ì´ ì •ë§ ì‹¬í•˜ì˜€ë‹¤. ë¬¼ë¡  ì´ëŸ° ìƒí™©ì„ ê°ì•ˆí•´ì„œ ìƒê°í•˜ì—¬ì•¼ì§€ë§Œ ì•„ë¬´ë˜ë„ ì²˜ìŒ ë„ì „í•œ ëŒ€íšŒë‹¤ ë³´ë‹ˆ í˜ë“¤ê¸°ë„ í•˜ì˜€ë‹¤. ëŒ€ì‹  ì´ ê²½í—˜ìœ¼ë¡œ ë°°ìš´ê²Œ ë§ìœ¼ë‹ˆ ë‹¤ìŒ ëŒ€íšŒì— ë„ì „í•˜ë©´ ë” ì¬ë°Œê²Œ ì˜ í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.
